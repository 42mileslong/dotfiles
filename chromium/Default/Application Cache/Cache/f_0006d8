Gx.prototype.K7=NR(59,function(){return jw(this,3)});bG.prototype.K7=NR(58,function(){return jw(this,5)});Gx.prototype.k5=NR(57,function(){return V(this,3)});bG.prototype.k5=NR(56,function(){return V(this,5)});Gx.prototype.M7=NR(55,function(){return jw(this,2)});bG.prototype.M7=NR(54,function(){return jw(this,4)});Gx.prototype.C5=NR(53,function(){return V(this,2)});bG.prototype.C5=NR(52,function(){return V(this,4)});function A_c(a,b){Uf(a,11).push(b)}
function B_c(a,b){var c=vu(a,b);return t(c)?String(vu(a,b)):null}function C_c(a,b){return(a=CU(a,b))?a.rect:null}function D_c(a,b){a.D=b}function E_c(a){Sf(this,a,0,-1,null,null)}x(E_c,Rf);function F_c(a){Sf(this,a,0,-1,null,null)}x(F_c,Rf);var G_c=/['()]/g;function H_c(a){return"%"+a.charCodeAt(0).toString(16)}function I_c(a){a=Ob(String(a));G_c.lastIndex=0;return G_c.test(a)?a.replace(G_c,H_c):a}function J_c(a){return null!=a?a:Number.MIN_VALUE}
function K_c(a){return null!=a?a:Number.MAX_VALUE}function L_c(a,b){return hsc(b)?hsc(a)&&V(a,1)==V(b,1):hsc(a)?J_c(V(a,1))>J_c(V(b,1))&&J_c(V(a,1))<K_c(V(b,2)):J_c(V(a,1))>=J_c(V(b,1))&&K_c(V(a,2))<=K_c(V(b,2))}function M_c(a){return a.wl()+Yb(a.C)};function N_c(a){return P('<input type="text" id="docs-copy-link" class="'+R("docs-copy-link")+'" value="'+R(a.link)+'" readonly="readonly">')};function t_(a,b,c,d){fq.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Ba="";this.F=b||null;this.qa=c||new wAb(a);this.ea=null!=d?d:null;a=new Xp;bq(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.qa.C()&&bq(a,{key:"copy-link",caption:"Copy Link"});$p(this,a)}x(t_,fq);p=t_.prototype;
p.xa=function(){t_.ma.xa.call(this);dh(Up(this),"copy-link-dialog");var a=aq(this.D,"done");dh(a,"copy-link-done-button");this.C=N(N_c,{link:this.Ba},void 0,this.oa());ei(this.C,"label","Link to this comment");this.Hb().appendChild(this.C);if(this.L=aq(this.D,"copy-link"))a=Xd("DIV"),dh(a,"copy-link-butter-holder"),this.getElement().insertBefore(a,Rp(this)),this.O=new uo(a),this.J=wo("Link copied to clipboard.","info",!1,4E3);null!==this.ea&&(rh(this.$w(),"z-index",this.ea),rh(Up(this),"z-index",
this.ea+1))};p.Cm=function(){t_.ma.Cm.call(this);this.F&&this.getHandler().R(this.F,"copy",this.ICa);this.C.focus();this.C.select()};p.Bo=function(){t_.ma.Bo.call(this);this.F&&this.getHandler().Nc(this.F,"copy",this.ICa)};p.Ia=function(){t_.ma.Ia.call(this);this.getHandler().R(this.C,"click",this.zTb);this.L&&this.getHandler().R(this.L,"click",this.Job)};p.eUb=function(a){this.Ba=a;this.C&&(this.C.value=a)};p.zTb=function(a){a.target.focus();a.target.select()};
p.Job=function(a){a.stopPropagation();this.F&&this.qa.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};p.ICa=function(a){a.C&&this.J&&this.O&&(this.J.isVisible()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};p.Fa=function(){t_.ma.Fa.call(this);C(this.J);delete this.J;delete this.L;delete this.C};function u_(){var a=new qO(null);TR(a,!0);return a};function O_c(a,b,c){E.call(this);this.D=a;this.Mi=b;this.Nb=c;this.V=this.H=this.Ga=this.Ba=this.$=this.F=null;this.Uc=new yS;this.Se=new yS;this.qa=this.O=null;this.zd=new yS;this.Rf=new yS;this.Ra=this.Na=this.Oa=this.ea=this.L=null;this.De=new yS;this.Me=new yS;this.bd=new yS;this.Ye=new yS;this.Sa=this.kc=null;this.C=new eX("");this.Ua=this.J=this.Ab=this.wb=this.Rd=this.Wb=this.Cb=this.kb=null;this.Ug=this.Fc=!1;this.ld=this.uf=this.Bb=this.ib=null;this.pe=new K(this);this.va(this.pe);this.Oc=
new yw;this.Fg=this.gi=this.wh=this.hg=this.Ih=this.Ja=null;this.Dx();a=this.pe;a.R(this.F,"action",this.qub);a.R(this.$,"action",this.Rka);a.R(this.Ba,"action",this.Rka);a.R(this.Ga,"action",this.Rka);a.R(this.J,"focus",Ba(this.qSa,!0));a.R(this.J,"blur",Ba(this.qSa,!1));a.R(this.J,"change",this.Fka);a.R(this.J,"keyup",this.Fka);b=[this.O,this.qa,this.H,this.V,this.L,this.ea,this.Na,this.Ra];for(c=0;c<b.length;c++)this.pe.R(b[c],"change",v(this.IYb,this,b[c])),this.pe.R(b[c],"keyup",v(this.lub,this,
b[c]));a.R(this.Bb,"change",v(this.UKa,this));a.R(this.Oa,"change",v(this.bGb,this));a.Jg(this.Ua,gf,this.qBb)}x(O_c,E);var P_c="placeholder"in document.createElement("input"),Q_c=/\s*,\s*/;function R_c(a){var b=a.Fg;b||(b=[{Ti:"List from a range",type:4},{Ti:"List of items",type:3},{Ti:"Number",type:0},{Ti:"Text",type:1},{Ti:"Date",type:2},{Ti:"Custom formula is",type:5}],Vg(I(),"fecdv")&&b.push({Ti:"Checkbox",type:6}),a.Fg=b);return b}
function S_c(a){var b=a.gi;b||(b=[{Ti:"contains",code:9,inputs:0,example:"Approved"},{Ti:"does not contain",code:10,inputs:0,example:"Approved"},{Ti:"equals",code:13,inputs:0,example:"Approved"},{Ti:"is valid email",code:14,inputs:-1,example:null},{Ti:"is valid url",code:15,inputs:-1,example:null}],a.gi=b);return b}
function T_c(a){var b=a.hg;b||(b=[{Ti:"is valid date",code:30,inputs:-1,example:null},{Ti:"equal to",code:16,inputs:2,example:"11/15/2014"},{Ti:"before",code:17,inputs:2,example:"11/15/2014"},{Ti:"on or before",code:19,inputs:2,example:"11/15/2014"},{Ti:"after",code:18,inputs:2,example:"11/15/2014"},{Ti:"on or after",code:20,inputs:2,example:"11/15/2014"},{Ti:"between",code:21,inputs:3,example:"11/15/2014",rP:"11/15/2015"},{Ti:"not between",code:22,inputs:3,example:"11/15/2014",rP:"11/15/2015"}],
a.hg=b);return b}function U_c(a){var b=a.wh;b||(b=[{Ti:"range",code:23,inputs:6,example:null},{Ti:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.wh=b);return b}
function V_c(a){var b=a.Ih;b||(b=[{Ti:"between",code:7,inputs:8,example:"10",rP:"100"},{Ti:"not between",code:8,inputs:8,example:"10",rP:"100"},{Ti:"less than",code:3,inputs:7,example:"10"},{Ti:"less than or equal to",code:4,inputs:7,example:"10"},{Ti:"greater than",code:1,inputs:7,example:"10"},{Ti:"greater than or equal to",code:2,inputs:7,example:"10"},{Ti:"equal to",code:5,inputs:7,example:"10"},{Ti:"not equal to",code:6,inputs:7,example:"10"}],a.Ih=b);return b}
function W_c(){return{Ti:"",code:29,inputs:0,example:"=ISODD(A1)"}}function X_c(){return{Ti:"",code:31,inputs:-1,example:""}}p=O_c.prototype;
p.Dx=function(){var a=this.D,b,c,d,e,f,h,k,l,m,r,u,w,y,B,H=a.oa(),Q;var Z=H.xa("TR","waffle-dv-trrules",H.xa("TD","waffle-dv-label",H.xa("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),H.xa("TD",{colspan:"7"},l=H.xa("DIV","goog-inline-block"),Q=H.xa("DIV","goog-inline-block"),h=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=H.xa("SPAN","waffle-dv-separator","and"),k=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.bd.Wa(h);this.Ye.Wa(k);this.zd.Wa(c);this.Rf.Wa(d);this.Uc.Wa(e);this.Se.Wa(f);var U=u_();Xh(U,l);var na=u_();Xh(na,l);var ja=u_();Xh(ja,l);var La=u_();Xh(La,l);var Fa=Y_c(a,Q);(w=U.getElement())&&ei(w,"labelledby","waffle-dv-criteria");
var Ja;var Qa=H.xa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",H.xa("TD"),H.xa("TD",{colspan:"7"},Ja=H.xa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show dropdown list in cell")));w=new Iq;qq(w,Ja);Xh(w,Ja);var lb=H.xa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",H.xa("TD"),H.xa("TD",{colspan:"7"},m=H.xa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var pb=new Iq;qq(pb,m);Xh(pb,m);var wb=H.xa("TR","waffle-dv-trrules",H.xa("TD"),H.xa("TD","waffle-dv-customcheckboxlabel",
H.xa("SPAN",{id:"customCheckboxInputLabel_checked"},"Checked:")),H.xa("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},r=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var Bb=H.xa("TR","waffle-dv-trrules",H.xa("TD"),H.xa("TD","waffle-dv-customcheckboxlabel",H.xa("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unchecked:")),H.xa("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},u=H.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));this.De.Wa(r);
this.Me.Wa(u);ei(r,"labelledby","customCheckboxInputLabel_checked");ei(u,"labelledby","customCheckboxInputLabel_unchecked");BS(this.De,"e.g., TRUE");BS(this.Me,"e.g., FALSE");var Lc=H.xa("TR","waffle-dv-trrules",H.xa("TD","waffle-dv-label",H.xa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),H.xa("TD",{colspan:"7"},H.xa("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},H.xa("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",
role:"radio"}),H.xa("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),H.xa("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),H.xa("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new Yzc(!0);Zzc(m,"onInvalidData",Lc);var lc=H.xa("TR","waffle-dv-trrules waffle-dv-trrules-appearance",H.xa("TD",null,H.xa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),H.xa("TD",{colspan:"7"},y=H.xa("SPAN","waffle-dv-label waffle-dv-checkbox-label",
"Show validation help text:")));var Uc=new Iq;qq(Uc,y);Xh(Uc,y);y=Uc.Da;var Pc=Bia(y,"labelledby");ei(y,"labelledby","waffle-dv-appearance "+Pc);y=H.xa("TR","waffle-dv-trrules",H.xa("TD"),H.xa("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},B=H.xa("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),Pc=H.xa("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));ue(Pc,!0);a=a.ea.childNodes[0];H.appendChild(a,Z);H.appendChild(a,
Qa);H.appendChild(a,lb);H.appendChild(a,wb);H.appendChild(a,Bb);H.appendChild(a,Lc);H.appendChild(a,lc);H.appendChild(a,y);this.C.render(l);H=this.C;H.mna=29;H.resize();H=this.C;H.DNa=200;H.resize();this.C.getElement().style.width="324px";P_c?this.C.getElement().placeholder="Enter items separated by a comma...":(H=this.C.getElement(),Ui(H,"Enter items separated by a comma...","Enter items separated by a comma..."));if(H=this.C.getElement())ii(H,"Enter items separated by a comma..."),eh(H,["waffle-dv-list-options-textarea",
"jfk-textinput"]);this.J=B;U.setVisible(!0);H=R_c(this);Z_c(this,H,U);H=V_c(this);Z_c(this,H,La);H=S_c(this);Z_c(this,H,na);H=T_c(this);Z_c(this,H,ja);$_c(this,U,La,na,ja,h,k,c,d,e,f,b,l,Fa,Qa,y,w,Ja,Pc,Uc,Q,m,pb,r,u,lb,wb,Bb)};
function $_c(a,b,c,d,e,f,h,k,l,m,r,u,w,y,B,H,Q,Z,U,na,ja,La,Fa,Ja,Qa,lb,pb,wb){a.F=b;a.F.setVisible(!0);a.Ba=c;a.$=e;a.Ga=d;a.kc=u;a.L=f;a.ea=h;a.O=k;a.qa=l;a.H=m;a.V=r;a.Sa=w;a.Ja=y;a.kb=ja;a.Oa=Fa;a.Na=Ja;a.Ra=Qa;a.Rd=lb;a.wb=pb;a.Ab=wb;L(a.Rd,!1);L(a.wb,!1);L(a.Ab,!1);na.Bc(!1);a.Bb=na;a.ld=La;a0c(a,!1);a.Cb=B;Q.Bc(!0);a.ib=Q;a.uf=Z;a.Wb=H;L(a.Wb,!0);b0c(a);c0c(a);a.Ua=U;L(a.Ua,!1)}
function d0c(a,b){L(a.Cb,23==b||24==b);a.uf.innerText="Show dropdown list in cell";b=31==b;L(a.Rd,b);var c=a.Oa.isChecked();L(a.wb,b&&c);L(a.Ab,b&&c)}function e0c(a){$_c(a,a.F,a.Ba,a.Ga,a.$,a.L,a.ea,a.O,a.qa,a.H,a.V,a.kc,a.Sa,a.Ja,a.Cb,a.Wb,a.ib,a.uf,a.Ua,a.Bb,a.kb,a.ld,a.Oa,a.Na,a.Ra,a.Rd,a.wb,a.Ab)}function Z_c(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.oa();e=new ok(b[d].Ti,null,e);c.Jd(e);e=e.getElement();di(e,"menuitem")}c.kf(0)}p.Rka=function(){c0c(this);this.J.value=f0c(this);this.dispatchEvent("change")};
p.qub=function(){b0c(this);c0c(this);this.J.value=f0c(this);this.dispatchEvent("change")};p.qSa=ca("Ug");p.Fka=function(a){this.Fc||a&&!Eka(a)||this.J.value===g0c(this)||(this.Fc=!0,L(this.Ua,!0))};p.qBb=function(){this.Fc=!1;this.J.value=f0c(this);L(this.Ua,!1)};p.UKa=function(){L(this.Wb,this.Bb.isChecked())};p.bGb=function(){var a=this.Oa.isChecked();a||h0c(this);L(this.wb,a);L(this.Ab,a);i0c(this)};function i0c(a){a.J.value=f0c(a)}function j0c(a){i0c(a);a.C.resize()}
p.IYb=function(a){i0c(this);k0c(this,a)?(this.D.ql=0,v_(a),this.dispatchEvent("change")):(this.D.ql=1,w_(a),this.dispatchEvent("error"))};p.lub=function(){this.dispatchEvent("keyup")};function k0c(a,b){if(0!=x_(a))return!0;var c=b.value;if(null!=c&&Oh(b)){if(!l0c(a.D))return!0;a=y_(a,c,m0c(a).code);return null!=a&&(jw(a,3)||jw(a,5)&&V(a,5).hd()&&3==V(V(a,5).Ma(),1))}return!0}function w_(a){a.select();dh(a,"waffle-input-error")}function v_(a){a&&fh(a,"waffle-input-error")}
function h0c(a){v_(a.C.getElement());v_(a.H);v_(a.V);v_(a.L);v_(a.ea);v_(a.Na);v_(a.O);v_(a.qa);v_(a.Ja.qr());a.D.ql=0;a.dispatchEvent("change")}function x_(a){return R_c(a)[a.F.Og()].type}function b0c(a){var b=x_(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.$.setVisible(c);a.Ba.setVisible(d);a.Ga.setVisible(e);L(a.Sa,f);L(a.kb,h);L(a.L,!1);L(a.ea,!1);L(a.O,!1);L(a.qa,!1);L(a.H,!1);L(a.V,!1);f&&a.C.resize();a.dispatchEvent("change")}
function m0c(a){var b;null!=n0c(a)?b=n0c(a):a.$.isVisible()?b=T_c(a)[a.$.Og()]:a.Ba.isVisible()?b=V_c(a)[a.Ba.Og()]:5==x_(a)?b=W_c():6==x_(a)?b=X_c():b=S_c(a)[a.Ga.Og()];return b}function n0c(a){var b=U_c(a);return 4==x_(a)?b[0]:3==x_(a)?b[1]:null}
function c0c(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,r=m0c(a);-1!=r.inputs&&(0==r.inputs?d=!0:1==r.inputs?k=e=d=!0:2==r.inputs?f=!0:3==r.inputs?k=h=f=!0:7==r.inputs?b=!0:8==r.inputs?k=c=b=!0:5==r.inputs?l=!0:6==r.inputs&&(m=!0));var u=m0c(a);if(3==x_(a))P_c?a.C.getElement().placeholder="Enter items separated by a comma...":(u=a.C.getElement(),Ui(u,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(u.example)if(0==u.inputs||1==u.inputs)BS(a.zd,"e.g., "+
u.example),BS(a.Rf,"e.g., "+u.rP||"");else if(2==u.inputs||3==u.inputs)BS(a.Uc,"e.g., "+u.example),BS(a.Se,"e.g., "+u.rP||"");else if(7==u.inputs||8==u.inputs)BS(a.bd,"e.g., "+u.example),BS(a.Ye,"e.g., "+u.rP||"");h0c(a);L(a.L,b);L(a.ea,c);L(a.O,d);L(a.qa,e);L(a.H,f);L(a.V,h);L(a.Sa,l);l&&a.C.resize();L(a.kb,m);d0c(a,r.code);L(a.kc,k)}
function y_(a,b,c){var d=l0c(a.D);if(""==b||null==d.kd)return null;var e=d.rect,f=e.rc();e=e.mc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.kd+"",f,e,b,c,!0))?a.Oc.xd(bx.Ca(),b):null}
function o0c(a){var b=new gx,c=m0c(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(y_(a,a.O.value,d));break;case 1:e.push(y_(a,a.O.value,d));e.push(y_(a,a.qa.value,d));break;case 2:e.push(y_(a,a.H.value,d));break;case 3:e.push(y_(a,a.H.value,d));e.push(y_(a,a.V.value,d));break;case 7:e.push(y_(a,a.L.value,d));break;case 8:e.push(y_(a,a.L.value,d));e.push(y_(a,a.ea.value,d));break;case 5:a=a.C.Ma().split(",");for(c=0;c<a.length;c++)e.push(Nsc(a[c]));break;case 6:c=z$a("="+a.Ja.Ma());e.push(y_(a,c,
d));break;case -1:a.Oa.isChecked()&&(e.push(y_(a,Mb(a.Na.value),d)),Kb(a.Ra.value)||e.push(y_(a,Mb(a.Ra.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=uS(d,e);W(b,1,d);return b}function p0c(a){var b=Mb(a.Ja.Ma());!a.Nb.C.D[Mb(Yb(b).toLowerCase())]&&BU(a.Nb,b)&&(b=hrc(a.Nb,b,!0));return b}function f0c(a){return a.Fc||a.Ug?a.J.value:g0c(a)}
function g0c(a){var b="";var c=x_(a);var d=4==c;c=3==c||4==c;if(a.$.isVisible())c=T_c(a)[a.$.Og()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Ga.isVisible())c=S_c(a)[a.Ga.Og()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid url":b+"Enter text that ";else if(c)c=n0c(a),b+="Click and enter a value from ";else if(5==x_(a))c=W_c(),b="Enter a value that satisfies the formula:";else if(6==x_(a))if(c=X_c(),a.Oa.isChecked()&&!Kb(Mb(a.Na.value))){b=Mb(a.Na.value);var e=
Mb(a.Ra.value);b=Kb(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=V_c(a)[a.Ba.Og()],b+="Enter a number ";-1!=c.inputs&&(b+=c.Ti);e=p0c(a);23==c.code&&""!=e&&d&&(d=hrc(a.Nb,e,!0))&&(b+=" "+d);Kb(Yb(a.O.value))||0!=c.inputs&&1!=c.inputs?Kb(Yb(a.H.value))||2!=c.inputs&&3!=c.inputs?Kb(Yb(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;Kb(Yb(a.qa.value))||1!=c.inputs?Kb(Yb(a.V.value))||3!=c.inputs?Kb(Yb(a.ea.value))||
8!=c.inputs||(b+=" and "+a.ea.value):b+=" and "+a.V.value:b+=" and "+a.qa.value;return b}function a0c(a,b){$zc(a.ld,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function z_(a,b){switch(b){case 0:a.F.kf(2);break;case 1:a.F.kf(3);break;case 2:a.F.kf(4);break;case 3:a.F.kf(1);break;case 4:a.F.kf(0);break;case 5:a.F.kf(5);break;case 6:a.F.kf(6)}}
function q0c(a,b,c,d,e){a.F.kf(0);a.$.kf(0);a.Ba.kf(0);a.Ga.kf(0);a.J.value="";a.L.value="";a.ea.value="";a.H.value="";a.V.value="";a.O.value="";a.qa.value="";a.C.Qa("");a.Ja.Qa("");a0c(a,!1);var f=a.Fc=!1,h=!1,k=!1,l=!1,m=!1,r=!1,u=!1,w=!1,y=!1,B=!1,H=!1,Q=!1,Z=!1,U=!1,na=!1,ja=!1,La=!1,Fa=!1,Ja=b&&V(b,1);b=Ja&&dx(Ja);if((Ja=Ja&&ex(Ja))&&b){for(var Qa=U_c(a),lb=T_c(a),pb=V_c(a),wb=S_c(a),Bb=W_c(),Lc=X_c(),lc=0,Uc=0;Uc<Qa.length;Uc++)if(b==Qa[Uc].code){lc=Qa[Uc].inputs;23==Qa[Uc].code?(ja=!0,z_(a,
4)):(Q=!0,z_(a,3));a.ib.Bc(!!e);break}for(e=0;e<lb.length;e++)if(b==lb[e].code){lc=lb[e].inputs;a.$.kf(e);z_(a,2);Z=w=!0;break}for(e=0;e<pb.length;e++)if(b==pb[e].code){lc=pb[e].inputs;a.Ba.kf(e);z_(a,0);U=y=!0;break}for(e=0;e<wb.length;e++)if(b==wb[e].code){lc=wb[e].inputs;a.Ga.kf(e);z_(a,1);na=B=!0;break}b==Bb.code&&(lc=Bb.inputs,z_(a,5),La=!0);b==Lc.code&&(lc=Lc.inputs,z_(a,6),Fa=!0);if(Z||na||U||Q||ja||La||Fa)if(na=l0c(a.D),Z=na.rect.rc(),U=na.rect.mc(),na=na.kd+"",-1==lc)Fa&&0<Ja.length&&(H=
!0,a.Oa.Bc(!0),a.De.Qa(sI(Ja[0],na,Z,U)),1<Ja.length&&a.Me.Qa(sI(Ja[1],na,Z,U)));else if(0==lc)m=sI(Ja[0],na,Z,U),a.zd.Qa(m),m=!0;else if(1==lc)r=sI(Ja[0],na,Z,U),m=sI(Ja[1],na,Z,U),a.zd.Qa(r),a.Rf.Qa(m),r=m=u=!0;else if(2==lc)f=sI(Ja[0],na,Z,U),a.Uc.Qa(f),f=!0;else if(3==lc)h=sI(Ja[0],na,Z,U),f=sI(Ja[1],na,Z,U),a.Uc.Qa(h),a.Se.Qa(f),h=f=u=!0;else if(7==lc)k=sI(Ja[0],na,Z,U),a.bd.Qa(k),k=!0;else if(8==lc)l=sI(Ja[0],na,Z,U),k=sI(Ja[1],na,Z,U),a.bd.Qa(l),a.Ye.Qa(k),l=k=u=!0;else if(5==lc){Q=!0;Fa=[];
for(lc=0;lc<Ja.length;lc++)Fa.push(sI(Ja[lc],na,Z,U));a.C.Qa(Fa.join(","));a.C.resize()}else 6==lc&&(ja=!0,Fa=sI(Ja[0],na,Z,U),null!=Fa&&(Fa=Fa.substring(1),Ja=!!AG(Fa),Fa=(lc=CG(Fa,a.Mi,!1,!0))?EG(lc.rect,lc.Kg):Fa,Ja||(Fa=BG(Fa)),a.Ja.Qa(Fa)));else a.F.kf(0),ja=!0;L(a.kc,u);a.$.setVisible(w);a.Ba.setVisible(y);a.Ga.setVisible(B);L(a.H,f);L(a.V,h);L(a.O,m);L(a.qa,r);L(a.L,k);L(a.ea,l);L(a.wb,H);L(a.Ab,H);L(a.Cb,!0);L(a.Sa,Q);a.C.resize();L(a.kb,ja);null!=b&&d0c(a,b)}else{if(Q0a){w=YK(a.Mi);y=w.Kc();
B=new pr;for(H=y.rc();H<y.Sc();H++)for(Q=y.mc();Q<y.Vc();Q++)ja=w.Wg(H,Q),""!=yI(ja)&&qr(B,yI(ja).split(Q_c));B.isEmpty()?w=!1:(e0c(a),a.C.Qa(B.Ad().join(",")),z_(a,3),b0c(a),w=!0)}else w=!1;w||e0c(a)}a.UKa();c=c||"";w=c.lastIndexOf("</strong>");-1!=w&&(c=Rb(Mb(c.substring(w+9))));a.Bb.Bc(!!c);c&&(f0c(a)!=c&&a.Fka(),a.J.value=c,L(a.Wb,!0));a0c(a,d)}
p.Fa=function(){this.Ra=this.Na=this.ea=this.L=this.qa=this.O=this.V=this.H=null;C(this.C);this.Cb=this.ib=this.Ua=this.J=this.kc=this.C=null;C(this.Ja);this.Ja=null;C(this.ib);this.ib=null;C(this.Ga);this.Ga=null;C(this.Ba);this.Ba=null;C(this.$);this.$=null;C(this.F);this.F=null;O_c.ma.Fa.call(this)};function r0c(a){var b=a.description;a=a.FRb;return P('<div class="waffle-dv-rec-chip" title="'+R(b)+'"><div class="waffle-dv-rec-range">'+O(a)+'</div><div class="waffle-dv-rec-description">'+O(b)+"</div></div>")}function s0c(){return P('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function t0c(a,b,c,d,e,f,h){Np.call(this);this.kb=a;this.zd=b;this.bd=c;this.ld=d;this.O=e;this.ib=f;this.kc=h;this.qa=new M(this.oa());this.Ha(this.qa);this.Wb=new zr("",new tW,this.oa());this.Ha(this.Wb);this.wb=new M(this.oa());this.Ha(this.wb);this.Oa=new rW(!1,"#4285f4");this.Ha(this.Oa);this.Fc=new vW(c,u0c.lca,u0c.mca);this.va(this.Fc);this.F=this.ea=null;this.Ua=new K(this);this.va(this.Ua);this.Sa=this.L=this.J=this.C=null;this.Ra=Vg(I(),"fedvs");this.Bb=this.Ba=null;this.Ab=-1;this.Nb=[];
this.Cb=[];this.Uc=-1;this.L=new Xp;this.L.set("save","Save",!1);this.L.set("clear","Remove validation",!1,!1);this.L.set("cancel","Cancel",!1,!0);$p(this,this.L);Wp(this,!1);this.render();a=this.Hb();b=this.oa();c=u0c;Op(this,"Data validation");this.J||(d=b.xa("DIV",{"class":c.bXa}),e=b.xa("DIV",{"class":c.aXa},d),b.appendChild(a,e),this.J=new to(e),this.J.setType("warning"),this.J.setContent(""),this.J.render(d),Gsa(this.J,!0),this.J.setVisible(!1));this.Ra&&(e=b.xa("DIV",c.C2a),f=b.xa("DIV",{id:v0c.Bxa},
"Suggested validations"),d=b.xa("DIV",c.B2a),h=b.xa("DIV",c.gua,"Send feedback"),b.appendChild(a,e),b.appendChild(e,h),b.appendChild(e,f),b.appendChild(a,d),this.Wb.Wa(h),L(h,qB),this.qa.Wa(d),e=b.xa("DIV",c.o2a),b.appendChild(d,e),this.wb.Wa(e),this.Oa.render(e),sW(this.Oa,!0));this.ea=b.xa("TABLE",{cellSpacing:"0","class":c.YD},b.xa("TBODY"));b.appendChild(a,this.ea);this.Ra&&dh(this.ea,c.J2a);a=this.Hb();a=Ld(a);b=a.xa("TR",u0c.Z2a);b.appendChild(a.xa("TD","waffle-dv-label",a.xa("LABEL",{id:"waffle-dv-cell-range"},
"Cell range: ")));c=a.xa("TD",{colspan:"7"});this.C=Y_c(this,c);w0c(this);b.appendChild(c);a.appendChild(this.ea.childNodes[0],b);(a=this.C.qr())&&ei(a,"labelledby","waffle-dv-cell-range");this.F=new O_c(this,this.kb,this.O);Pq(this,"save");x0c(this)}x(t0c,Np);
var u0c={aXa:"waffle-input-error-butter-container",bXa:"waffle-input-error-butter-wrap",gua:"waffle-dv-feedback-link",lca:"waffle-dv-highlight-styled-border",mca:"waffle-dv-highlight-styled-rect",Gua:"waffle-input-error",o2a:"waffle-dv-rec-spinner-container",hda:"waffle-dv-rec-chip-selected",B2a:"waffle-dv-rec-wrapper",C2a:"waffle-dv-recs-title-bar",YD:"waffle-dv-table",J2a:"waffle-dv-table-with-suggestions",Z2a:"waffle-dv-trrules"},v0c={Bxa:"waffle-dv-recs-title"};p=t0c.prototype;p.ql=0;
function w0c(a){if(a.C){var b=a.kb.getActiveGrid();b&&(b=EG(vH(a.bd).Kc(),b.Vd(),!0),a.C.Qa(b))}}function x0c(a){a.Ua.R(a,"dialogselect",a.HYb).R(a.F,"error",a.jub).R(a.F,"change",a.GYb);a.Ra&&a.Ua.R(a.ib,"recommender-calc-ended",a.FYb).R(a.Wb,"action",function(){J.Du.jc({source:"dataValidationDialogFeedback"})})}p.jub=function(){y0c(this)};p.GYb=function(){y0c(this);cq(this.L,"save",!0)};function z0c(a){var b=a.oa();a=a.qa.Da;var c=N(s0c);b.appendChild(a,c)}
p.FYb=function(a){var b=this;sW(this.Oa,!1);L(this.wb.Da,!1);a=a.C;if(0==a.length)z0c(this);else for(var c=this.oa(),d=this.qa.Da,e=0,f=A0c(this),h=!1,k={Ce:0};k.Ce<a.length;k={jH:k.jH,$v:k.$v,N_:k.N_,Ce:k.Ce,Oe:k.Oe,lD:k.lD},k.Ce++){var l=a[k.Ce],m=V(l,13);if(3<=e||!m)break;e++;k.Oe=yU(l);k.N_=EG(dB(k.Oe));k.$v=V(m,3);this.Nb.push(k.$v);this.Cb.push(k.N_);m="";switch(dx(k.$v)){case 14:m="Is valid email";break;case 15:m="Is valid URL";break;case 30:m="Is valid date";break;case 24:m="List: "+ex(k.$v).map(function(a){return V(V(a,
5).Ma(),2)}).join();break;case 1:m="Greater than "+V(V(ex(k.$v)[0],5).Ma(),3);break;case 7:m=ex(k.$v);m="Between "+(V(V(m[0],5).Ma(),3)+(" and "+V(V(m[1],5).Ma(),3)));break;case 5:m=ex(k.$v);m="Equal to "+V(V(m[0],5).Ma(),3);break;default:bdc.C("Unrecognized data validation type.")}var r=v0c;k.lD=N(r0c,{description:m,FRb:k.N_});k.jH=new Br("",c);k.jH.Ze(8,!0);k.jH.Wa(k.lD);ei(k.lD,"describedby",r.Bxa);this.qa.Ha(k.jH);c.appendChild(d,k.lD);this.Ua.R(k.jH,"action",function(a){return function(){B0c(b,
a.jH,a.$v,a.N_,a.Ce)}}(k)).R(k.lD,"mouseenter",function(a){return function(){wW(b.Fc,JU(a.Oe))}}(k)).R(k.lD,"mouseleave",function(){xW(b.Fc)}).R(k.lD,"focus",function(a){return function(){Dh(a.lD,d)}}(k));l=.98<=V(l,2);!h&&(!f||VU(f,k.Oe)||Msc(f,k.Oe)&&l&&(l||24==dx(k.$v)||7==dx(k.$v)||5==dx(k.$v)))&&(h=!0,k.jH.dispatchEvent("action"))}};
function B0c(a,b,c,d,e){var f=u0c,h=ch(b.Da,f.hda);a.qa.jf(function(a){a.wk(f.hda,!1);a.Lc(!1)});b.wk(f.hda,!h);b.Lc(!h);h?(a.show(!0),a.Ba=null,a.Bb=null,a.Ab=-1):(b=new gx,W(b,1,c),q0c(a.F,b,null,null,!0),j0c(a.F),a.C.Qa(d),a.Ba=c,a.Bb=d,a.Ab=e)}p.HYb=function(a){if("save"==a.key){if(!C0c(this)){a.preventDefault();return}}else{var b;if(b="clear"==a.key)(b=A0c(this))?(this.kc.Vb(35300),this.ld.C(new GS(new py,b)),b=!0):b=!1,b=!b;if(b){a.preventDefault();return}}this.C&&this.C.Pa(!1)};
function y0c(a){var b=D0c(a.ql);b&&a.J.setContent(b);a.J.setVisible(0!=a.ql);b=2==a.ql||4==a.ql;var c=u0c,d=a.oa().Kw(a.C.getElement());hh(d,c.Gua,b);b&&a.C.qr().select()}
function D0c(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid checked value.";case 9:return"Enter different values for checked and unchecked cell contents.";case 10:return"Formulas are not permitted as custom checked/unchecked values."}return null}
function E0c(a){var b=a.F,c=x_(b);if(0==c){c=b.L;var d=b.ea,e=k0c(b,c),f=k0c(b,d);e&&f?b.D.ql=0:(e||w_(c),f||w_(d),b.D.ql=1)}else if(1==c)c=b.O,d=b.qa,e=!Oh(c)||!Kb(Yb(c.value)),f=!Oh(d)||!Kb(Yb(d.value)),e&&f?b.D.ql=0:(e||w_(c),f||w_(d),b.D.ql=6);else if(2==c)c=b.H,d=b.V,e=!Oh(c)||!Kb(Yb(c.value)),f=!Oh(d)||!Kb(Yb(d.value)),e&&f?b.D.ql=0:(e||w_(c),f||w_(d),b.D.ql=7);else if(3==c||4==c)c=0,4==x_(b)?(d=p0c(b),BU(b.Nb,d)?(d=p0c(b),d=CU(b.Nb,d),e=l0c(b.D),null!=d&&null!=e&&d.kd==e.kd&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==x_(b)&&b.C.getElement()&&Kb(Yb(b.C.Ma()))&&(c=5),d=c,c=0==d,b.D.ql=d,d=b.kb&&Oh(b.kb),b.Sa&&Oh(b.Sa)?(hh(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.oa().Kw(b.Ja.getElement()),hh(d,"waffle-input-error",!c),b.Ja.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.Oa.isChecked()){c=b.Na;e=b.Ra;d=Mb(Yb(c.value));e=Mb(Yb(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==e.toLowerCase();
var h=ec(d)==ec(e);f=d==e||h||f;Kb(d)?(w_(c),b.D.ql=8):f?b.D.ql=9:UM(d)||UM(e)?b.D.ql=10:b.D.ql=0}}else b.D.ql=0;b=a.C.Ma();b=BU(a.O,b);2==a.ql&&b?a.ql=0:0!=a.ql||b||(a.ql=2);y0c(a);return 0!=a.ql}
function C0c(a){if(E0c(a))return!1;var b=a.F,c=b.ld.isChecked("rejectInvalidData_radio"),d=f0c(b);b.Bb.isChecked()||(d="");var e=o0c(b);if(!e)return!1;var f=new py;W(f,1,e);W(f,2,d);W(f,3,c);Rqc(f,Oh(b.Cb)&&b.ib.isChecked());b=A0c(a);if(!b)return!1;c=new gg;e=V(e,1);d=a.Ba&&dx(a.Ba)==dx(e);var h=ex(e);if(d){var k=ex(a.Ba),l=F0c(a,C_c(a.O,a.Bb));k=xb(k,h,function(a,b){return a.equals(b)});l=!VU(l,b);G(c,12,!k||!l);var m=new E_c;G(m,1,!l);G(m,2,!k);G(m,3,a.Ab);PR(c,17,lfa[0],m)}else{for(var r=m=l=k=
!1,u=!1,w=0;w<a.Cb.length;w++){var y=F0c(a,C_c(a.O,a.Cb[w]));if(y){var B=VU(y,b);y=Msc(y,b);var H=a.Nb[w],Q=dx(H)==dx(e);H=ex(H);H=xb(H,h,function(a,b){return a.equals(b)});u|=H;k|=B&&Q&&H;l|=B;m|=B&&Q;r|=y}}w=new F_c;G(w,1,k);G(w,2,l);G(w,3,m);G(w,4,r);G(w,5,u);PR(c,18,lfa[0],w)}Mqc(c,kyc(dx(e)));k=ha(a.Nb);for(l=k.next();!l.done;l=k.next())A_c(c,kyc(dx(l.value)));k=Da()-a.Uc;G(c,14,1E3*k);k=new eg;Yf(k,58,c);c=nj(oj(new jj,k),1).build();a.kc.Vb(d?35578:35301,c);31==dx(e)&&a.kc.Vb(0<h.length?35604:
35603,c);a.ld.C(new GS(f,b));return!0}function A0c(a){var b=C_c(a.O,a.C.Ma());return F0c(a,b)}function F0c(a,b){var c=a.C.Ma();a=(a=CU(a.O,c))?a.kd:null;return b&&null!=a?bB(b,a):null}function l0c(a){var b=a.C.Ma();return CU(a.O,b)}function Y_c(a,b){var c=a.kb.C.Vd();c=new kW(a.bd,v(a.EYb,a),!1,"e.g., Sheet1!A2:D5",!0,c,a.oa());a.getHandler().R(c,"change",function(){var a=this.F;a&&i0c(a)});c.render(b);return c}
p.setVisible=function(a){t0c.ma.setVisible.call(this,a);a&&this.Sa&&(this.Sa.focus(),this.Sa=null)};p.EYb=function(a,b,c,d){this.Sa=a.qr();this.zd.lba(this,a,b,c,!1,!0,d)};
p.show=function(a){var b="",c=!1,d=YK(this.kb),e=EI(cJ(d,hJ(d)));d=null;var f=!1;e&&(e=e.Tx,d=V(e,1),b=V(e,2),c=V(e,3),f=V(e,4));q0c(this.F,d,b,c,f);this.setVisible(!0);this.C&&this.C.Pa(!0);w0c(this);j0c(this.F);this.Ra&&!a&&(yqc(this.ib)?(Yqc(this.ib),Grc(this.ib,!0,!1,[6])):(sW(this.Oa,!1),L(this.wb.Da,!1),z0c(this)));this.Uc=Da()};p.Fa=function(){C(this.F);this.F=null;C(this.C);this.L=this.ea=this.C=null;t0c.ma.Fa.call(this)};function G0c(a,b,c,d,e){Np.call(this);this.Fc=d.O;this.Sa=c;this.ib=d.C;this.Oa=d;this.Wb=e;this.Ua=null;this.Bb=d.$;Op(this,"Find and replace");Wp(this,!1);c=this.Hb();d=Ld(c);this.C=d.xa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Ba=d.xa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new qO(null);this.Uc=b;this.O=new kW(this.Sa,v(this.nZb,this),!1,"",!0);this.ea=null;this.qa=new Iq;this.Ra=new Iq;this.L=new Iq;this.J=new Iq;this.Nb=this.wb=this.Ab=
this.Cb=!1;this.kb=d.xa("SPAN");Hsc(this.kb);this.kc=new Rq(this.C);this.va(this.kc);a=H0c;d.xa("LABEL",{"for":a.kua},"Search");b=d.xa("LABEL",{"for":a.lva},"Match case");e=d.xa("LABEL",{"for":a.mva},"Match entire cell contents");var f=d.xa("LABEL",{},"Also search within formulas"),h=d.xa("LABEL",{"for":a.Vwa},"Search using regular expressions "),k=(new jl(I0a)).toString(),l=d.xa("SPAN",null,d.xa("A",{target:"_blank",href:k},"Help"));this.getHandler().R(l,["keydown","keypress"],function(a){13==a.keyCode&&
a.stopPropagation()});k=Yh(this,"findLabel");var m=Yh(this,"replaceLabel"),r=Yh(this,"findScopeLabel"),u=d.xa("DIV","goog-inline-block"),w=d.xa("DIV",a.I1a);l=d.xa("TABLE",null,d.xa("TBODY",null,d.xa("TR",null,d.xa("TD",a.LABEL,d.xa("LABEL",{id:k},"Find")),d.xa("TD",null,this.C)),d.xa("TR",null,d.xa("TD",a.LABEL,d.xa("LABEL",{id:m},"Replace with")),d.xa("TD",null,this.Ba)),d.xa("TR",null,d.xa("TD",null,d.xa("LABEL",{id:r},"Search")),d.xa("TD",null,u,w)),d.xa("TR",null,d.xa("TD",null,""),d.xa("TD",
null,b,d.xa("BR"),e,d.xa("BR"),h,l,d.xa("BR"),f)),d.xa("TR",null,d.xa("TD",{colspan:"2"},this.kb))));this.F.render(u);dh(this.F.getElement(),a.kua);this.O.render(w);Xh(this.qa,b);qq(this.qa,b);this.qa.getElement().id=a.lva;Xh(this.Ra,e);qq(this.Ra,e);this.Ra.getElement().id=a.mva;Xh(this.L,h);qq(this.L,h);this.L.getElement().id=a.Vwa;qq(this.J,f);Xh(this.J,f);ei(this.C,"labelledby",k);ei(this.Ba,"labelledby",m);ei(this.F.Da,"labelledby",r);d.appendChild(c,l);c=new Xp;c.set("findNext","Find",!0);c.set("replace",
"Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);$p(this,c);Pq(this,"");this.getHandler().R(this,"dialogselect",this.oZb).R(this.kc,"input",this.Ula).R(this.L,"change",this.cCb).R(this.F,"change",this.tsb).R(this.O,"change",this.pZb).R(this.J,"change",this.dCb);c=new Sq;c.Wa(this.C);this.va(c);c=new Sq;c.Wa(this.Ba);this.va(c);I0c(this);c=new Lp(this.getElement());this.va(c);this.getHandler().R(c,"focusin",this.DVa).R(this.getElement(),"mousedown",this.DVa)}x(G0c,Np);
var H0c={Psa:"waffle-find-replace-dialog-border",kua:"waffle-find-replace-find-scope-select",Gua:"waffle-input-error",LABEL:"waffle-find-replace-dialog-label",lva:"find-replace-case",mva:"find-replace-cell",Vwa:"find-replace-regex",I1a:"waffle-find-replace-selection-input goog-inline-block"};
function I0c(a){var b=vH(a.Sa),c=null,d=null;b&&(c=TIb(b),d=LG(a.ib,c.kd).Vd());a.J.Bc(a.Bb);var e=new ok("All sheets",a8a.zWa),f=new ok("This sheet",a8a.R1a),h=new ok("Specific range",a8a.cI);a.F.Jd(e);a.F.Jd(f);a.F.Jd(h);f=c?FJ(a.ib,c.kd):null;f=(f=c&&f?SI(f,c.rect.rc(),c.rect.mc()):null)?f.dh():1;c&&c.rect.dh()>f?Qr(a.F,h):Qr(a.F,e);b&&a.O.Qa(EG(c.rect,d))}function J0c(a){var b=a.F.bf().Ta(),c=zJ(a.Sa.C);return 0==b?CG(a.O.Ma(),a.ib,!1,!0):1!=b||null===c?null:new WA(c,"",new EA(0,0,1,1))}p=G0c.prototype;
p.DVa=function(a){a.target==this.getElement()?this.focus():this.Wb.Db(2)};p.pZb=function(){K0c(this)};p.dCb=function(){var a=this.J.isChecked();p7b(this.Oa,a)};p.tsb=function(){K0c(this)};p.cCb=function(){this.L.isChecked()&&this.qa.Bc(!0);this.Ula()};
p.oZb=function(a){var b=L0c;if("findNext"==a.key)a.preventDefault(),this.Cb&&(A_(this,null),M0c(this,b.jua));else if("replace"==a.key)a.preventDefault(),this.Ab&&(A_(this,null),M0c(this,b.jwa));else if("replaceAll"==a.key&&(a.preventDefault(),this.Nb)){a=v(function(){A_(this,null);M0c(this,b.iwa)},this);var c=this.F.bf().Ta();1<this.ib.D.length&&2==c&&!this.wb?(uqc("Replace in all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.wb=!0):a()}};
p.Ula=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;aq(this.D,"findNext").disabled=!a;this.Cb=a;N0c(this,a);this.Ab&&!a&&O0c(this,!1);hh(this.C,"waffle-input-error",b)};p.nZb=function(a,b,c){this.Ua=a.qr();this.Uc.lba(this,a,b,c,!1,!0)};
function K0c(a){var b=0==a.F.bf().Ta();a.O.setVisible(b);C(a.ea);a.ea=null;var c=J0c(a),d=vH(a.Sa);b&&d&&c&&(a.ea=iO(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.ea.setVisible(!0),a.va(a.ea))}function M0c(a,b){if(0==a.F.bf().Ta()&&null==J0c(a))hh(a.O.D,"waffle-range-selection-error",!0),A_(a,"Invalid range");else{var c=a.F.bf().Ta();a.dispatchEvent(new P0c(b,a.C.value,a.Ba.value,c,a.qa.isChecked(),a.Ra.isChecked(),a.L.isChecked(),a.J.isChecked(),J0c(a)))}}
p.setVisible=function(a){var b=this.Oa.Ed();N0c(this,!b);O0c(this,!b);this.Ba.disabled=b;G0c.ma.setVisible.call(this,a);a&&this.Ua&&(this.Ua.focus(),this.Ua=null)};p.YTb=function(a){this.C.value=a};p.MRa=function(){this.C.select()};p.focus=function(){this.Rb()&&this.isVisible()&&(this.C.focus(),this.Wb.Db(2),Os(this.C,this.C.value.length),this.Ula())};function O0c(a,b,c){b=b&&!a.Oa.Ed()&&0==!a.C.value.length;a.Ab=b;a=aq(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function N0c(a,b){var c=!!Za(hkb(a.Fc),function(a){return!a.tj()});b=b&&!a.Oa.Ed()&&!c&&0==!a.C.value.length;a.Nb=b;a=aq(a.D,"replaceAll");a.disabled=!b;c&&(a.title="This is disabled because there are protected cells in this spreadsheet.")}function A_(a,b){var c=Ld(a.Hb());a=a.kb;b?(0<ke(a).length&&c.appendChild(a,c.xa("BR")),c.appendChild(a,c.xa("B",null,Ee(c,b)))):c.Cd(a)}p.Fa=function(){G0c.ma.Fa.call(this);this.wb=!1;p7b(this.Oa,this.Bb)};
function P0c(a,b,c,d,e,f,h,k,l){D.call(this,a);this.F=b;this.J=c;this.C=d;this.V=e;this.$=f;this.Ba=h;this.Ga=k;this.Ja=l||null}x(P0c,D);var L0c={jua:"findnext",lec:"findall",jwa:"replace",iwa:"replaceall",DONE:"done",t6b:"canceled"};function Q0c(a,b,c,d,e){A.call(this);var f=L0c;this.H=null;this.C=a;this.D=b;this.F=c;this.O=d;this.L=e;this.J=new K(this);this.va(this.J);this.J.R(a,f.iwa,this.jBb).R(a,f.jwa,this.kBb).R(a,f.jua,this.CVa).R(a,f.DONE,this.uqb)}x(Q0c,A);var B_={mN:"cg",nN:"cr",lN:"cc",iua:"loop"};p=Q0c.prototype;p.ZVb=function(){this.C.setVisible(!0);R0c(this,null)};p.CVa=function(a){if(wH(this.D.C)){var b=vH(this.D).Ta(),c=this.H;c||(c=hJ(b),c=Dc(B_.mN,b.Zb(),B_.nN,rJ(b,c.y),B_.lN,sJ(b,c.x)));S0c(this,a,b,c)}};
function S0c(a,b,c,d){var e=new yw,f=T0c(b);U0c(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.xd((new d8a).Ca(),a);a=V(f,1);var d=b.type;wH(this.D.C)&&(c?jw(c,1)?(d=V(c,1),c=Dc(B_.mN,parseInt(d.yb(),10),B_.nN,d.Wr(),B_.lN,d.getColumnIndex(),B_.iua,V(c,2)),V0c(this,a,c)):(V0c(this,a,{}),"replace"==d&&this.C.focus()):W0c(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function U0c(a,b,c){if(c){var d=""+c[B_.mN],e=new ny;W(e,1,d);W(e,2,Aib(b,c[B_.nN],"r"));W(e,3,Aib(b,c[B_.lN],"c"));W(a,10,e)}}
function T0c(a){var b=new kF;W(b,1,a.F);W(b,3,a.J);W(b,5,a.C);if(0==a.C||1==a.C){var c=a.Ja,d=new Pw;W(d,1,""+c.kd);var e=c.rect.rc();W(d,2,e);Qw(d,c.rect.Sc());d.tu(c.rect.mc());d.Hx(c.rect.Vc());b.setSelection(d)}W(b,6,a.V||!1);W(b,7,a.$||!1);W(b,8,a.Ba||!1);b.setType(a.Ga?1:0);W(b,11,0);return b}function V0c(a,b,c){c?c&&null!=c.cg?(b=c[B_.mN],c[B_.iua]&&A_(a.C,"No more results found, looping around"),a.F.kA(b,v(a.mZb,a,c))):(R0c(a,null),A_(a.C,"There are no entries matching "+b)):W0c(a)}
p.mZb=function(a){var b=vH(this.D).Ta(),c=a[B_.nN],d=a[B_.lN];a[B_.nN]=rJ(b,c);a[B_.lN]=sJ(b,d);R0c(this,a);a=new Dd(d,c);b=new WA(b.Zb(),"",GA(a));DU(this.F,b,v(this.d4a,this,a))};
p.d4a=function(a){if(!this.isDisposed()){this.C.focus();var b=vH(this.D).Ta();CI(b.Wg(a.y,a.x))&&!this.C.J.isChecked()&&O0c(this.C,!1,"Can't replace formula");var c=UI(b,a.y),d=VI(b,a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=DG(a),a=yI(cJ(b,a)),A_(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function W0c(a){A_(a.C,null);A_(a.C,"Error while searching spreadsheet. Please try again.")}
p.kBb=function(a){if(!this.L.Ed()){var b=this.H;if(b){var c=zI(this.F,b[B_.mN]);if(c){c=c.Jc();var d=Aib(c,b[B_.nN],"r"),e=Aib(c,b[B_.lN],"c"),f=c.Wg(d,e);if(!CI(f)||this.C.J.isChecked()){f=yI(f);var h=new yw,k=T0c(a);W(k,5,0);U0c(k,c,b);var l=new Pw;W(l,1,""+b[B_.mN]);W(l,2,d);Qw(l,d+1);l.tu(e);l.Hx(e+1);k.setSelection(l);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);X0c(this,c,k,f,b,!1);this.CVa(a)}}}}};
p.jBb=function(a){if(!this.L.Ed()&&wH(this.D.C)){var b=this.F.getActiveGrid().Jc(),c=T0c(a);X0c(this,b,c,a.F,a.J,!0)}};
function X0c(a,b,c,d,e,f){b=new fX(b,c);HG(b,v(function(a,b){a?(a=V(b,5),b=V(b,4),b=0==a?"No matches found":f?(new At(1==b?"{NUM_CHANGED, plural,=0 {unused plural form}=1 {Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other {Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS, plural,=0 {unused plural form}=1 {unused plural form}other {Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:d,
NEW_VALUE:e}):'Replaced "'+(d+('" with "'+(e+'"'))),A_(this.C,null),A_(this.C,b)):W0c(this)},a));A_(a.C,null);A_(a.C,"Working...");a.O.C(b)}p.uqb=function(){R0c(this,null)};function R0c(a,b){a.H=b;(a=a.C)&&O0c(a,null!=b)};function Y0c(a){a=a||{};var b=a.type;return P('<input class="'+R("jfk-textinput")+(a.Od?" "+R(a.Od):"")+'"'+(a.id?' id="'+R(a.id)+'"':"")+(a.maxLength?' maxlength="'+R(a.maxLength)+'"':"")+(a.Z9&&a.zXb?' label="'+R(a.Z9)+'"':"")+(a.name?' name="'+R(a.name)+'"':"")+(a.Z9?' placeholder="'+R(a.Z9)+'"':"")+' type="'+R(null!=b?b:"text")+'"'+(a.pattern?' pattern="'+R(a.pattern)+'"':"")+(a.value?' value="'+R(a.value)+'"':"")+(a.dir?' dir="'+R(a.dir)+'"':"")+(a.attributes?" "+Cq(a.attributes):"")+">")};function Z0c(a){a=""+(""+$0c({id:"waffle-resize-selection-custom",TMa:a.cga,Jk:yq("<br/>"+O(Y0c({id:"waffle-resize-input",Od:"waffle-resize-inset-input"})))})+$0c({id:"waffle-resize-selection-auto",TMa:xq("Fit to data"),Jk:yq("")})+"");return P(a)}function $0c(a){return P('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+R(a.id)+'"><label for="'+R(a.id)+'" class="waffle-resize-label">'+O(a.TMa)+"</label>"+O(a.Jk)+"</div>")}
function a1c(a){var b=a.Ceb;a='<label for="waffle-resize-input">'+O(a.cga)+'</label><br/><br/><input id="waffle-resize-input"/>';b&&(a+='<br/><br/><span class="waffle-resize-dialog-checkbox"><span id="waffle-resize-rows-can-grow-checkbox">Allow row heights to grow automatically to fit cell contents.</span></span>');return P(a+"")};function b1c(a,b,c,d,e){Np.call(this);this.L=a;this.Ba=b;var f=this.L.Kc().ad();this.C=f;this.F=Ua(this.L.Oj(),function(a){return a.ad()==f});this.J=new yS;this.O=new Yzc(!0);this.ea=new Iq;this.Oa=c;this.Ra=d;this.qa=e}x(b1c,Np);var c1c={AUTO:"waffle-resize-selection-auto",rr:"waffle-resize-selection-custom",oca:"waffle-resize-input",v0a:"waffle-resize-selection",A1a:"waffle-resize-rows-can-grow-checkbox"};p=b1c.prototype;
p.xa=function(){b1c.ma.xa.call(this);var a=this.F[0];if("r"==this.C){var b=a.rc();a=a.Sc()-1;var c=String(uG(b+1)),d=String(uG(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.mc(),a=a.Vc()-1,c=wG(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+wG(a)));Op(this,b);"r"==this.C?this.Hb().appendChild(N(a1c,{cga:d1c(this),Ceb:Vg(I(),"fefrha")})):this.Hb().appendChild(N(Z0c,{cga:d1c(this)}));Pq(this,
"ok")};p.Ia=function(){b1c.ma.Ia.call(this);var a=this.oa(),b="r"==this.C;this.J.Wa(a.getElement(c1c.oca));Vg(I(),"fefrha")&&b&&(a=a.getElement(c1c.A1a),qq(this.ea,a),Xh(this.ea,a));a=this.L.Kc();var c=a.ad();a=Ocb(mib(this.L,c,NA(a,c)));this.J.Qa(String(a));b||(Zzc(this.O,c1c.v0a),$zc(this.O,c1c.rr));this.getHandler().R(this,"dialogselect",this.H_b).R(this.J.getElement(),"focus",this.eGb)};p.eGb=function(){"c"==this.C&&$zc(this.O,c1c.rr)};p.focus=function(){this.Rb()&&CS(this.J)};
function d1c(a){return"r"==a.C?"Enter new row height in pixels. (Default: "+(OI+")"):"Enter new column width in pixels. (Default: "+(Qcb+")")}
p.H_b=function(a){if("ok"==a.key)if((a="r"==this.C)||aAc(this.O)==c1c.rr){var b=parseInt(this.J.Ma(),10);isNaN(b)?NB("Entered value is not a number."):2>b||2E3<b?NB("Size must be between 2 and 2000 pixels."):(this.qa.C("r"==this.C?35310:35308),b=new EL(this.L,this.F[0],b,this.F.slice(1)),Vg(I(),"fefrha")&&a&&(a=!this.ea.isChecked(),b.L=a),this.Ba.C(b))}else a=vH(this.Oa).$.D,this.qa.C(35307),AVb(this.F,a,this.Ra,this.Ba)};function e1c(a){Sf(this,a,0,-1,null,null)}x(e1c,Rf);e1c.prototype.getType=function(){return F(this,3)};e1c.prototype.setType=function(a){G(this,3,a)};function f1c(a){M.call(this,a);this.$=vB("email");this.C=this.D=null}x(f1c,M);p=f1c.prototype;
p.xa=function(){var a=this.oa();var b=this.oa();this.C=new UV;this.va(this.C);this.D=new UV;this.va(this.D);var c=b.xa("DIV","waffle-dialog-notifications-input");di(c,"presentation");this.F=new SV;TV(this.F,b.xa("LABEL",null,"Any changes are made"));this.F.render(c);this.C.mG(this.F);var d=b.xa("DIV","waffle-dialog-notifications-input");di(d,"presentation");this.J=new SV;TV(this.J,b.xa("LABEL",null,"A user submits a form"));this.J.render(d);this.C.mG(this.J);var e=b.xa("DIV","waffle-dialog-notifications-input");
di(e,"presentation");this.H=new SV;TV(this.H,b.xa("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.mG(this.H);var f=b.xa("DIV","waffle-dialog-notifications-input");di(f,"presentation");this.L=new SV;TV(this.L,b.xa("LABEL",null,"Email - right away"));this.L.render(f);this.D.mG(this.L);b=b.xa("DIV",null,b.xa("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.$+" when...")),b.xa("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.$+" when...")},c,d),b.xa("DIV",{style:"padding: 5px"}),
b.xa("DIV","waffle-dialog-notifications-label","Notify me with..."),b.xa("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.oa();d=c.xa("DIV");this.O=jS("Save",c);this.Ha(this.O,!1);this.O.render(d);this.V=new Br("Cancel",c);this.Ha(this.V,!1);this.V.render(d);this.Da=a.xa("DIV","waffle-dialog-notifications",a.xa("DIV",null,b),a.xa("DIV",null,d))};
p.Ia=function(){f1c.ma.Ia.call(this);this.getHandler().R(this.O,"action",this.hTb,!0).R(this.V,"action",v(this.dispatchEvent,this,new D("cancelRuleEdit"))).R(this.C,"change",this.Nra).R(this.D,"change",this.Nra)};p.Dd=function(a){f1c.ma.Dd.call(this,a);a?1==a.getType()?VV(this.C,this.F):2==a.getType()&&VV(this.C,this.J):VV(this.C,null);a?2==F(a,2)?VV(this.D,this.H):1==F(a,2)&&VV(this.D,this.L):VV(this.D,null);this.Nra()};p.focus=function(){var a=WV(this.C),b=this.C.C.ef(0);(a||b).getElement().focus()};
p.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};p.hTb=function(){this.dispatchEvent(new D("saveRule",g1c(this)))};function g1c(a){var b=new e1c,c=a.Ta();c&&(c=F(c,1),G(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?G(b,2,1):a.H.isChecked()&&G(b,2,2);return b}p.Nra=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.Pa(a)};function h1c(a){return P("<div><div>"+O(a.u6a)+"</div>"+O(Hq({id:"waffle-confirm-suppress-checkbox",Od:"waffle-confirm-suppress-checkbox"},void 0))+'<span id="waffle-confirm-suppress-label">'+O(a.Mqa)+"</span></div>")};function i1c(a,b,c,d,e,f,h){if(ya(c)){var k=new Xp;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=Dza;return j1c(d||"Heads up!",a,b,k,e,f,h)}function j1c(a,b,c,d,e,f,h){b=od(b);if(f){b=iq(h1c({u6a:b,Mqa:f}));var k=new Iq;var l=c;c=function(){l(k.isChecked())}}a=MAa(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Ha(k),k.Wa(Ae(a.oa(),"waffle-confirm-suppress-checkbox")),c=Ae(a.oa(),"waffle-confirm-suppress-label"),qq(k,c),k.Bc(!1));return a};function C_(a,b){M.call(this,b);this.Dd(a)}x(C_,M);
C_.prototype.xa=function(){var a=this.Ta(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==F(a,2)?c+="send digest email":1==F(a,2)&&(c+="send email");c="If "+(b+(" then "+c));var d=this.oa();a=d.xa("TD",null);b=d.xa("TD",{width:"50px"});c=d.xa("TR",{valign:"center"},d.xa("TD",null,d.xa("SPAN","waffle-notification-rule",c)),d.xa("TD",{align:"right"},d.xa("TABLE",null,d.xa("TBODY",null,d.xa("TR",null,a,b)))));d=ki(xr,"waffle-notifications-add");this.D=new zr("Edit",
d,this.oa());this.D.$d("goog-link-button");this.D.$d("menuMainLink");this.Ha(this.D,!1);this.D.render(a);this.C=new zr("Delete",d,this.oa());this.C.$d("goog-link-button");this.C.$d("menuMainLink");this.Ha(this.C,!1);this.C.render(b);this.Da=c};C_.prototype.Ia=function(){C_.ma.Ia.call(this);this.getHandler().R(this.D,"action",this.H);this.getHandler().R(this.C,"action",this.F)};C_.prototype.H=function(){this.dispatchEvent(new D("edit",this.Ta()))};
C_.prototype.F=function(){var a=v(function(){this.dispatchEvent(new D("del",this.Ta()))},this),b=v(function(){this.C.getElement().focus()},this);i1c("Are you sure you want to delete this notification rule?",a,void 0,void 0,b)};function k1c(a){M.call(this,a);this.C=null}x(k1c,M);k1c.prototype.xa=function(){var a=this.oa();this.C=a.xa("TBODY");this.Da=a.xa("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C)};k1c.prototype.Hb=g("C");k1c.prototype.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};function l1c(a,b,c){Np.call(this);this.L=b;Op(this,"Set notification rules");Wp(this,!1);a=new Xp;a.set("cancel","Done",!1,!0);$p(this,a);this.C=new f1c(c);this.Ha(this.C,!1);this.F=new k1c;this.Ha(this.F,!1);this.J=new zr("Add another notification rule",aQ.getInstance(),this.oa());this.Ha(this.J,!1)}x(l1c,Np);p=l1c.prototype;
p.xa=function(){l1c.ma.xa.call(this);var a=this.oa(),b=nob(new jl(F0a+"91588")).toString();b=a.xa("A",{target:"_blank",href:b},"Help");var c=a.xa("DIV");this.J.render(c);this.ea=a.xa("DIV");this.O=a.xa("DIV");var d=a.xa("DIV","waffle-dialog-notifications-bounds",this.ea,this.O);b=a.xa("DIV",null,a.xa("DIV",{align:"right"},b),d,c);a.appendChild(this.Hb(),b);Pq(this,"")};
p.Ia=function(){l1c.ma.Ia.call(this);this.F.render(this.ea);this.C.render(this.O);this.getHandler().R(this,"edit",this.Q_b).R(this,"del",this.P_b).R(this.J,"action",this.O_b).R(this,"saveRule",this.gTb).R(this,"cancelRuleEdit",this.D5a)};p.d_=function(a){this.isDisposed()||(this.C.setVisible(!1),m1c(this,!1),gB(this.L,"/notifications/list",v(this.hXb,this,a)).le())};
p.hXb=function(a,b,c){if(!this.isDisposed()){b=c.Te();c=[];for(var d=0;d<b.length;d++)c[d]=new e1c(b[d]);this.Dd(c);if(a&&0==c.length)n1c(this,null,!1);else{if(a=this.Ta())if(b=this.F,b.Cd(!0),b.oa().Cd(b.Hb()),b.Dd(a),c=b.oa(),0==a.length)c.appendChild(b.Hb(),c.xa("TR",null,c.xa("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Ha(new C_(a[d],c),!0);m1c(this,!0);this.focus()}}};
p.gTb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();F(a,1)?Uq(gB(this.L,"/notifications/set",v(this.d_,this,!1)),{rule:b}).le():Uq(gB(this.L,"/notifications/create",v(this.d_,this,!1)),{rule:b}).le()};p.D5a=function(){this.C.setVisible(!1);this.d_(!1)};p.Q_b=function(a){n1c(this,a?a.target:null,!0)};p.O_b=function(){n1c(this,null,!0)};function n1c(a,b,c){m1c(a,!1);var d=a.C;d.Dd(b);d.setVisible(!0);c&&a.C.focus()}
p.P_b=function(a){this.F.setVisible(!1);a=a.target;Uq(gB(this.L,"/notifications/delete",v(this.d_,this,!1)),{rule_id:F(a,1)}).le()};function m1c(a,b){a.F.setVisible(b);var c=Tp(a);L(c,b);a.J.setVisible(b)}p.show=function(){this.setVisible(!0);this.d_(!0)};function o1c(a,b,c){b=c||b;c="";var d='<span id="ds-settings-link-desc">Display language: </span><a aria-labelledby="ds-settings-link-desc ds-settings-link" id="ds-settings-link" target="_blank">'+(O(a.J7a)+"</a>");c+='<tr class="dialog-settings-general-settings-div"><div>'+d+"</div>";a.WUb&&(c+='<div class="dialog-settings-english-name-div">'+O(Hq({id:"waffle-settings-dialog-english-name-checkbox"},b))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">Always use English function names</label></div>');
return P(c+"</tr>")}function p1c(){return P('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function D_(a,b,c,d){Np.call(this);this.Cb=a;this.Uc=b;this.ea=c;this.kc=d;this.C={};this.Ab=this.ib=!1;this.Wb=this.Bb=this.wb="";this.Fc=new yw;this.J=[];this.F=this.Fc.xd((new Hx).Ca(),ritz_api.RitzModelApi.getWorkbookProperties());Op(this,"Settings for this spreadsheet");this.Ua=!1;this.Ra=new Iq;this.Ha(this.Ra);this.O=new ZU;this.Ha(this.O);this.L=new ZU;this.Ha(this.L);this.kb=new qV;this.Ha(this.kb);this.Oa=this.Sa=null;this.Nb=new xt(1);this.qa=this.Ba="";this.C[0]=u_();this.C[1]=u_();this.C[2]=
u_();this.C[3]=u_();this.C[4]=new yS;this.C[5]=new yS}x(D_,Np);var q1c=null,r1c={X1:0,P2a:1,LWa:2,l_a:3,E_a:4,LXa:5},s1c={r3a:"waffle-settings-dialog-english-name-checkbox",s3a:"waffle-settings-dialog-english-name-checkbox-label"},t1c=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],u1c=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];p=D_.prototype;
p.xa=function(){D_.ma.xa.call(this);var a=this.Hb(),b=this.oa(),c=[v1c(b,"Locale","waffle-settings-label-locale"),w1c(this,b,"This affects formatting details such as functions, dates, and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),x1c(this),v1c(b,"Time zone","waffle-settings-label-timezone"),w1c(this,b,"Your spreadsheet's history will be recorded in this time zone. This will affect all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
x1c(this)],d=[];d.push(v1c(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(w1c(this,b,"This affects how often NOW, TODAY, RAND, and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(x1c(this));d.push(v1c(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=nob(new jl(F0a+"58515")).toString();e=b.xa("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(w1c(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=v1c(b,"Max number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=w1c(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");y1c(e);d.push(e);this.J.push(e);e=v1c(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=w1c(this,
b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");y1c(e);d.push(e);this.J.push(e);"OFF"==this.C[3].bf().Ma()&&z1c(this);d.push(x1c(this));c=jb(c,d);c.push(N(o1c,{J7a:this.Bb,WUb:this.Ua}));this.Sa=b.xa("TABLE","dialog-settings",b.xa("TBODY",null,c));this.Oa=b.xa("table","dialog-settings",b.xa("tbody",null,d));c=N(p1c);b.appendChild(a,c);this.kb.Wa(c);b.appendChild(a,
this.Sa);b.appendChild(a,this.Oa);L(this.Oa,!1);q1c||(a=new Xp(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),q1c=a);$p(this,q1c);A1c(this,4,jw(this.F,3)&&V(this.F,3).M7()?V(this.F,3).C5().toString():"50");A1c(this,5,jw(this.F,3)&&V(this.F,3).K7()?V(this.F,3).k5().toString():"0.05");Pq(this,"save")};function y1c(a){a=a.firstChild.firstChild;dh(a,"jfk-textinput");rh(a,"width","7em")}function z1c(a){for(var b=0;b<a.J.length;b++)L(a.J[b],!1)}
function v1c(a,b,c){return a.xa("TR",null,a.xa("TD",{id:c,"class":"dialog-settings-label"},b))}function w1c(a,b,c,d,e,f,h){b=b.xa("TR",null,b.xa("TD","dialog-settings-input"),b.xa("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.Da;ei(a,"labelledby",e);ei(a,"describedby",f);return b}function x1c(a){a=a.oa();return a.xa("TR",null,a.xa("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.xa("HR",{"class":"dialog-settings-sep"})))}
p.Ia=function(){D_.ma.Ia.call(this);df(this,"dialogselect",v(this.f0b,this));this.getHandler().R(this.C[3],"action",this.lVb);this.getHandler().R(this.kb,"select",this.JEb);var a=this.C[4].getElement();this.O.nj(a);bV(this.O,a,a);this.O.render();aV(this.O);this.getHandler().R(a,"change",v(this.EXb,this));a=this.C[5].getElement();this.L.nj(a);bV(this.L,a);this.L.render();aV(this.L);this.getHandler().R(a,"change",v(this.DXb,this));if(this.Ua){a=this.oa().getElement(s1c.r3a);var b=this.oa().getElement(s1c.s3a);
this.Ra.Wa(a);qq(this.Ra,b);this.Ra.Bc(!T0a||hob(this.ea.F))}};p.setVisible=function(a){if(a){if(!this.ib){B1c(this);return}var b=this.ea.L;A1c(this,0,b.C);b=b.J||ztb().name();A1c(this,1,b);A1c(this,2,jw(this.F,3)&&V(this.F,3).hla()?V(this.F,3).Vha().toString():"");A1c(this,3,jw(this.F,3)&&jw(V(this.F,3),1)?V(V(this.F,3),1)?"ON":"OFF":"OFF")}D_.ma.setVisible.call(this,a);this.ib&&!this.Ab&&((a=Od("ds-settings-link"))&&ud(a,this.wb),this.Ab=!0)};
function B1c(a){Tq(a.Uc.He("/info/settings").yf(C1c()),v(function(a){a=a.Te();(a={locale:a.l?this.AJ(a.l):null,cUa:a.tz?this.AJ(a.tz):null,R7a:a.dls,GJb:a.dln,BXb:a.hl},a.locale)&&a.cUa&&(D1c(this,0,a.locale),D1c(this,1,a.cUa),D1c(this,2,t1c),D1c(this,3,u1c),this.wb=a.R7a,this.Bb=a.GJb,this.Wb=a.BXb,this.Ua=T0a&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.Wb),this.ib=!0);this.setVisible(!0)},a)).le()}
function C1c(){var a=ul(vB("win").location.href),b=sl(a,"hl");a=sl(a,"forcehl");return["hl",b,"forcehl",a]}function D1c(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new ok(e.caption,e.value);a.Jd(e);e=e.getElement();di(e,"menuitem")}a.xc().getElement().style.overflow="auto";TR(a,!0)}p.AJ=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function A1c(a,b,c){(a=a.C[b])&&a.Qa(c)}
p.f0b=function(a){if("save"==a.key)if("ON"!=this.C[3].bf().Ma()||""==this.Ba&&""==this.qa){E1c(this);a=this.ea.L.C;this.Cb.C(F1c(this));this.Cb.C(G1c(this));if(this.Ua){var b=!T0a||hob(this.ea.F);var c=this.Ra.isChecked();b!=c?(sob(this.ea,c),b=nj(new jj,1).build(),this.kc.Vb(c?2433:2434,b),c=!0):c=!1}else c=!1;c||(c=this.C[0].bf(),c=null!=c&&c.Ma()!=a);c&&Ypa(this.ea.D.C,this.e0b)}else a.preventDefault(),E1c(this),""!=this.Ba&&$U(this.O,this.Ba,!0),""!=this.qa&&$U(this.L,this.qa,!0)};
p.lVb=function(a){if("ON"==a.target.Ma())for(a=0;a<this.J.length;a++)L(this.J[a],!0);else z1c(this);E1c(this)};function E1c(a){aV(a.O);aV(a.L)}p.EXb=function(){this.Ba="";var a=this.C[4].Ma()||"";a=this.Nb.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Ba="Please enter an integer value.";else if(0>=a||1E4<a)this.Ba="Please enter a value between 1 and 10000."};p.DXb=function(){this.qa="";var a=this.C[5].Ma()||"";a=this.Nb.parse(a);isNaN(a)?this.qa="Please enter a numeric value.":0>a&&(this.qa="Please enter a non-negative value.")};
p.JEb=function(a){switch(a.target.getId()){case "general-settings-tab":L(this.Sa,!0);L(this.Oa,!1);break;case "calculation-settings-tab":L(this.Sa,!1),L(this.Oa,!0)}};function F1c(a){var b=a.C;var c=b[r1c.LWa].bf().Ma();var d=b[r1c.l_a].bf().Ma();a=b[r1c.E_a].Ma()||"";b=b[r1c.LXa].Ma()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new GL(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function G1c(a){var b=a.C;a=a.ea.L;var c=b[r1c.X1].bf();c=null==c?a.C:c.Ma();b=b[r1c.P2a].bf();b=null==b?a.J||ztb().name():b.Ma();return new pub(c,b)}p.e0b=function(){(new rub).exec()};p.Fa=function(){hc(this.C,C);delete this.C;D_.ma.Fa.call(this)};function H1c(a,b,c,d,e,f,h){Np.call(this,void 0,!1,h);this.L=this.J=this.ea=this.O=null;this.Ba=a;this.C=b;this.F=[];this.qa=new Rac(a,d,e,f)}q(H1c,Np);p=H1c.prototype;
p.xa=function(){Np.prototype.xa.call(this);var a=this.oa(),b=this.C.Kc(),c=DG(UA(b)),d=DG(new Dd(b.left+b.width-1,b.top+b.height-1));Op(this,"Sort range from "+(c+(" to "+d)));I1c||(c=new Xp,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),I1c=c);$p(this,I1c);Pq(this,"save");var e;c=a.xa("DIV",{style:"overflow: hidden"},d=a.xa("SPAN","jfk-checkbox"),e=a.xa("SPAN",{style:"cursor: default"},"Data has header row"));var f=this.L=new Iq(void 0,a);f.Wa(d);qq(f,e);1==b.height&&f.Pa(!1);eL(this.Ba,this.C.Zb(),
b)||(f.Bc(!0),f.Pa(!1));Vg(I(),"fetdrisd")&&ritz_api.TablesApi.getTables((new yw).serialize(bB(b,this.C.Zb())),v(function(a){if(0<a.length){var c=a[0];a=A$b(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c))c=$A(a),c=1==V(c,2)-V(c,1);c&&(c=bB(b,this.C.Zb()),c=a.yb()==c.yb()&&L_c($A(a),$A(c))&&L_c(aB(a),aB(c)));c&&f.Bc(!0)}},this));d=this.Hb();a.appendChild(d,c);this.O=a.xa("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.xa("TABLE",{cellSpacing:"0"},
this.ea=a.xa("TBODY")));a.appendChild(d,this.O);c=J1c(this);this.F.push(c);c=a.xa("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);ue(c,!0);di(c,"button");this.J=c};p.Ia=function(){Np.prototype.Ia.call(this);this.getHandler().R(this,"dialogselect",this.HKb).Jg(this.J,gf,this.Okb).R(this.L,"change",this.rtb)};
function J1c(a){var b=a.oa(),c=0==a.F.length,d=new K1c(a,c,a.C,a.F.length,b),e=b.xa("TR",null,b.xa("TD",{colspan:"4"},b.xa("DIV","waffle-sd-row-separator")));d.render(a.ea);b.appendChild(a.ea,e);c||a.getHandler().Jg(d.D,gf,v(a.m7a,a,d));a=L1c(a);M1c(d,a);return d}p.m7a=function(a){var b=this.F;if(1<b.length){var c=Sa(b,a);-1!=c&&(ib(b,c),b=a.getElement(),b=me(b),a.dispose(),ie(b),L(this.J,!0),this.J.focus(),OB("Sort criteria removed."))}};
function L1c(a){var b=a.C.Kc(),c=b.mc();b=b.Vc();var d=Va(a.F,function(a){return a.Pj()},a);if(d)for(var e=qJ(a.C,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=sJ(a.C,f);if(!ab(d,h))return h}return null}p.rtb=function(){for(var a=this.F,b=0;b<a.length;b++)M1c(a[b])};p.Okb=function(){var a=SA(this.C.Kc(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(J1c(this)),OB("Sort criteria added."));Dh(Ra(this.F).getElement(),this.O,!0);this.O.scrollLeft=0;this.F.length>=a&&L(this.J,!1)};
p.HKb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(e.Pj());e=e.F.isChecked();b.push(e?1:0)}c=this.C.Kc();d=SA(c,"r");if(this.L.isChecked()&&1<d){d=c.rc()+1;e=c.mc();var f=c.Sc(),h=c.Vc();c.top=d;c.left=e;c.height=f-d;c.width=h-e}a=new Qac(a,b,this.C,c,this.L.isChecked());Sac(this.qa,this.C,a)}};p.Fa=function(){Np.prototype.Fa.call(this);Db(this.F)};var I1c=null;
function K1c(a,b,c,d,e){M.call(this,e);this.J=this.L=this.F=this.C=this.D=null;this.V=-1;this.$=a;this.O=b;this.H=c}q(K1c,M);K1c.prototype.Pj=function(){var a=this.C.bf();return a?a.Ma():-1};
K1c.prototype.xa=function(){var a=this.oa(),b=this.O?"sort by":"then by",c,d,e,f=a.xa("TR","waffle-sd-tr-rules",a.xa("TD","waffle-sd-delete",this.O?"":this.D=a.xa("SPAN",{title:"Remove sort criteria."},"x")),a.xa("TD","waffle-sd-td-rules",a.xa("LABEL",{id:Yh(this,"csl")},b)),b=a.xa("TD","waffle-sd-column-selector"),a.xa("TD","waffle-sd-td-ascending",e=a.xa("DIV",null,c=a.xa("DIV",{title:"Ascending"}),d=a.xa("DIV",{title:"Descending"}))));di(e,"radiogroup");e=this.F=new SV(a,Fe(a,Fo(WM(!0,this.Ke()))),
"ascending");e.render(c);a=this.L=new SV(a,Fe(a,Fo(WM(!1,this.Ke()))),"descending");a.render(d);this.J=new UV([e,a]);VV(this.J,e);a=this.C=u_();a.render(b);ei(a.getElement(),"label",this.O?"Select first column to sort by:":"Select next column to sort by:");this.D&&(ue(this.D,!0),di(this.D,"button"),ii(this.D,"Remove sort criteria."));this.Da=f};
function M1c(a,b){var c=a.oa(),d=a.$.L.isChecked(),e=a.H.Kc(),f=e.rc(),h=e.mc();e=e.Vc();a.V=b||a.Pj();for(b=a.C.Yi();0<b;b--)a.C.MB(0);for(;h<e;h++)b=Tb(yI(a.H.Wg(f,h)),25),b=new ok(Kb(b)||!d?"Column "+wG(h):b,sJ(a.H,h),c),b.$d("waffle-sd-menu-item"),a.C.Jd(b);a.C.kf(0);0<=a.V&&a.C.Qa(a.V)}K1c.prototype.Fa=function(){M.prototype.Fa.call(this);this.C=this.D=this.H=this.$=null;C(this.F);C(this.L);C(this.J);this.J=this.L=this.F=null};function N1c(a,b,c){return LAa(a||"There was a problem",od(b),void 0,void 0,void 0,void 0,c)};function O1c(a,b){Np.call(this,"docs-material-dialog",a,b);$p(this,null);Zp(this,!0);Vp(this,this.pJ?0:.6);this.O=new YW("Ok");this.Ha(this.O);this.C=new Lzc("Cancel");this.Ha(this.C)}q(O1c,Np);p=O1c.prototype;p.Ia=function(){var a=this;Np.prototype.Ia.call(this);this.getHandler().R(this.O,"action",function(){return a.o7()}).R(this.C,"action",function(){a.dispatchEvent("fe")&&a.setVisible(!1)}).R(this.Da,"keypress",this.wKb)};
p.wKb=function(a){13==a.keyCode&&(a.target==yza(this)||a.target==this.C.getElement()?this.dispatchEvent("fe")&&this.setVisible(!1):("TEXTAREA"!=a.target.tagName&&"SELECT"!=a.target.tagName&&"A"!=a.target.tagName||a.target.disabled)&&this.o7())};p.o7=function(){this.dispatchEvent("ee")&&this.setVisible(!1)};p.xa=function(){Np.prototype.xa.call(this);var a=Tp(this);this.C.render(a);this.O.render(a);L(a,!0);kq(yza(this),Nzc)};p.KB=function(a){Np.prototype.KB.call(this,a);Vp(this,this.pJ?0:.6)};function P1c(a,b,c){O1c.call(this);Op(this,"Grouping rule");this.qa=a;this.Oa=b;this.Ba=c;this.ea=new M;this.Ha(this.ea,!0);this.F=new Q1c("Minimum value","e.g. 0",!0);this.ea.Ha(this.F,!0);this.L=new Q1c("Maximum value","e.g. 100",!0);this.ea.Ha(this.L,!0);this.J=new Q1c("Interval size","e.g. 10",!1);this.Ha(this.J,!0);(a=this.qa.C.getActiveGrid())&&(a=wJ(a.Jc()))&&(a=R1c(this,a))&&jw(a,10)&&jw(V(a,10),3)&&(a=V(V(a,10),3),jw(a,1)&&(b=this.F,c=V(a,1),b.rL.Qa(gX.format(c))),jw(a,2)&&(b=this.J,c=V(a,
2),b.rL.Qa(gX.format(c))),jw(a,3)&&(b=this.L,a=V(a,3),b.rL.Qa(gX.format(a))))}q(P1c,O1c);
P1c.prototype.o7=function(){var a=S1c(this.F),b=S1c(this.J),c=S1c(this.L);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(T1c(this.J,"Must be greater than 0"),d=!1):null!=a&&null!=c&&a>=c?(T1c(this.F,"Value too large"),d=!1):d=!0;if(d){d=new Hy;d.setType(2);var e=new Ky;null!=a&&W(e,1,a);null!=b&&W(e,2,b);null!=c&&W(e,3,c);W(d,3,e);if(a=this.qa.C.getActiveGrid())if(a=a.Jc(),b=wJ(a))if(c=R1c(this,b))W(c,10,d),this.Oa.C(new WO(b,a));O1c.prototype.o7.call(this)}};
function R1c(a,b){b=Ggb(b,function(b){return b.DX()==a.Ba});if(0==b.length)return null;if(1==b.length)return b[0];if(2==b.length)return jw(b[0],10)?b[0]:b[1]}function Q1c(a,b,c,d){M.call(this,d);this.J=a;this.L=b;this.O=c;this.H=new M;this.Ha(this.H,!0);this.rL=new cX;this.Ha(this.rL,!0);this.F=null;this.C=new M;this.Ha(this.C,!0);this.D=new ZU(this.oa(),!0,!0);this.va(this.D)}q(Q1c,M);
Q1c.prototype.Ia=function(){M.prototype.Ia.call(this);this.Da.className="waffle-pivot-histogram-errorable-input";this.H.Da.className="waffle-pivot-histogram-dialog-caption";this.oa().Je(this.H.getElement(),this.J);this.F=this.rL.Gd().oL(this.rL.Da);this.F.placeholder=this.L;ii(this.F,this.J+" - "+this.L);bV(this.D,this.F);this.C.Da.className="waffle-pivot-histogram-dialog-error";di(this.C.Da,"alert");ei(this.C.Da,"live","polite");U1c(this)};
function S1c(a){U1c(a);var b=a.rL.Ma();if(Kb(b)){if(a.O)return null;T1c(a,"Required");return NaN}b=gX.parse(b);isNaN(b)&&T1c(a,"Must be a number");return b}function T1c(a,b){a.C.Da.style.visibility="";a.oa().Je(a.C.Da,b);$U(a.D,b,!1)}function U1c(a){a.C.Da.style.visibility="hidden";aV(a.D)};function V1c(a){return P("<li class='nfd-format-pill'><div class='nfd-format-display'>"+O(a.tfb)+"</div><div class='nfd-format-sample'>"+O(a.uSb)+"</div></li>")};function W1c(a,b,c){M.call(this);this.Dd(a);this.D=b;this.C=c}x(W1c,M);p=W1c.prototype;p.xa=function(){var a=this.Ta(),b=this.C?cba(aS(a),30):aS(a);a=this.C?f7b(a,this.D):"";this.Da=N(V1c,{tfb:b,uSb:a})};p.Ia=function(){W1c.ma.Ia.call(this);ue(this.getElement(),!0);var a=new Rj(this.getElement());this.va(a);this.getHandler().R(a,"key",this.b2b).R(this.getElement(),"mousedown",this.a2b).R(this.getElement(),"dblclick",this.vqb)};
p.b2b=function(a){function b(a,b){for(;b=a(b);)if(Oh(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(me,this.getElement());break;case 38:b(Wca,this.getElement())}};p.a2b=function(a){a.preventDefault();this.dispatchEvent("change")};p.vqb=function(){this.dispatchEvent("action")};function X1c(a,b,c){M.call(this);this.D=b;this.C=c;Y1c(this,a)}x(X1c,M);X1c.prototype.xa=function(){this.Da=this.oa().xa("UL","nfd-pill-container")};function Y1c(a,b){z(b,function(b){a.Ha(new W1c(b,a.D,a.C),!0)})}X1c.prototype.filter=function(a){a=a.toLowerCase();this.jf(function(b){var c=Kb(Yb(a)),d=aS(b.Ta()).toLowerCase();c=c||Sb(d,a);L(b.getElement(),c)})};function E_(a){Np.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Efa();this.Ha(this.input,!0);this.J=new M;this.Ha(this.J,!0);a=this.K5();ob(a,void 0,M_c);this.C=new X1c(a,this.LX(),this.$Sa());this.J.Ha(this.C,!0);$p(this,null);this.aj=!0}x(E_,Np);p=E_.prototype;p.$Va=Le;p.$Sa=Ke;p.isEmpty=function(){return Kb(this.input.Ma())};p.Ue=function(){return this.input.Ta().Ue()};p.xa=function(){E_.ma.xa.call(this);var a=Xd("DIV","dialog-separator");he(a,Rp(this))};
p.Ia=function(){E_.ma.Ia.call(this);dh(this.J.getElement(),"nfd-dialog-content");this.getHandler().R(this.C,"change",this.Hsb).R(this.C,"action",this.Wra).R(this.input.O,"action",this.Wra).R(this.input,"afterhide",this.alb);this.input.V&&this.getHandler().R(this.input.V,"input",this.U1b);var a=this.input.qa;a&&this.getHandler().R(a,"key",this.V1b);a=this.K5()[0];this.input.iM(a)};p.alb=function(a){a.stopPropagation()};p.Hsb=function(a){this.input.iM(a.target.Ta());Z1c(this.input,!1)};
p.U1b=function(){this.C.filter(this.input.Ma());Z1c(this.input,!this.input.Ta().Ue())};p.V1b=function(a){13==a.keyCode&&this.Wra()};p.Wra=function(){this.Ue()&&!this.isEmpty()?(c3a.jc(new bS(this.u1(),void 0,this.$Va())),this.setVisible(!1)):(Z1c(this.input,!0),this.input.DEa())};function F_(a,b,c,d,e){ok.call(this,b,c,d,e);this.C=a}x(F_,ok);F_.prototype.Qj=function(){var a=F_.ma.Qj.call(this),b=this.getParent();return b&&b instanceof fk&&!b.isVisible()?this.C(a,this.Ta()):a};function G_(a){M.call(this);this.J=new M;this.va(this.J);this.D=new yS("");this.va(this.D);this.O=new Br("");this.va(this.O);this.$=a;this.qa=null}x(G_,M);p=G_.prototype;
p.Ia=function(){G_.ma.Ia.call(this);var a=$h(this,"nfd-icwr");this.J.Wa(a);this.Ha(this.J);if(a=$h(this,"nfd-i"))this.D.Wa(a),this.D.Id(this.J),fh(this.D.getElement(),"jfk-textinput"),a=new Sq,a.Wa(this.D.getElement()),this.va(a),this.V=a=new Rq(this.D.getElement()),this.va(a),this.qa=a=new Rj(this.D.getElement()),this.va(a),a=new Lp(this.D.getElement()),this.getHandler().R(a,"focusout",Ba(this.YVa,!1)).R(a,"focusin",Ba(this.YVa,!0)).R(this.V,"input",this.T1b);a=$h(this,"nfd-a");this.O.Wa(a);this.Ha(this.O)};
p.Ma=function(){return this.D.Ma()};p.T1b=function(){var a=this.Ta(),b=this.Ma();W(a.JG,2,b);this.ZVa()};p.ZVa=Le;p.YVa=function(a){hh(this.J.getElement(),"nfd-input-focus",a)};p.iM=function(a){this.Dd(a.clone());this.D.Qa(aS(a));try{this.D.getElement().focus()}catch(b){}};p.DEa=function(){this.D.getElement().focus()};function Z1c(a,b){a=a.J.getElement();hh(a,"nfd-invalid",b)};function $1c(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+R(a.tZ)+"'>"+a2c(a)+"</div>"+b2c(a,b)+"</div>")}function c2c(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+R(a.tZ)+"'></div>"+b2c(a,b)+"</div>")}
function d2c(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+R(a.tZ)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+a2c(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+R(a.iIb)+"'></div></div></div></div>"+b2c(a,b)+"</div>")}
function e2c(){var a=""+("<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+f2c({label:""})+f2c({label:yq("Negative:")})+f2c({label:yq("Zero:")})+f2c({label:yq("Text:")})+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>");return P(a)}function f2c(a){return P("<tr><td class='nfd-sample-label'>"+O(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function b2c(a,b){a=""+O(Ar({id:a.wV,style:2,Od:"nfd-apply",content:xq("Apply")},b));return P(a)}function a2c(a){return P(O(Y0c({id:a.lMa,Z9:a.mMa,zXb:!0})))};function g2c(a){G_.call(this,a);this.F=new M;this.C=new qO("")}x(g2c,G_);p=g2c.prototype;p.xa=function(){this.Da=N(d2c,{tZ:Yh(this,"nfd-icwr"),lMa:Yh(this,"nfd-i"),mMa:this.$,iIb:Yh(this,"nfd-ic"),wV:Yh(this,"nfd-a")})};p.Ia=function(){g2c.ma.Ia.call(this);var a=$h(this,"nfd-ic");this.F.Wa(a);this.F.Id(this.J);this.F.Ha(this.C,!0);this.getHandler().R(this.C,"aftershow",this.W1b).R(this.C,"action",this.mJa).R(this.V,"input",Ba(this.SUa,null))};
p.iM=function(a){g2c.ma.iM.call(this,a);a.C&&this.D.Qa(wt[a.C][1]);this.SUa(a)};
p.SUa=function(a){a=a?a.C:void 0;var b=this.C;b.Hf(null);if(a){var c=this.Ta(),d=c.C;h2c(this,c);c=Wac(d,wt[d][2]);c=new bS(i2c(c),Vac[d],d);h2c(this,c);c=Wac(d,d+" "+wt[d][1]);d=new bS(i2c(c),Vac[d],d);h2c(this,d)}else this.Ta().C=null;var e="[$"+this.Ma()+"]";d=a?Vac[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new bS(i2c(c[e]),d,a);h2c(this,f)}b.kf(0);this.mJa();dh(b.xc().getElement(),"number-format-menu")};function h2c(a,b){var c=new F_(function(a){return cba(a,25)},f7b(b,1E3),b);a.va(c);a.va(b);c.$o(!0);a=a.C;for(b=0;b<a.Yi();b++)if(a.ef(b).Qj()==c.Qj())return;a.Jd(c)}p.mJa=function(){for(var a=this.C,b=0;b<a.Yi();b++)a.ef(b).Bc(!1);a.uH()};p.W1b=function(){this.C.bf().Bc(!0)};function i2c(a){var b=new Ew;W(b,2,a);b.setType(4);return b};function j2c(a){E_.call(this,a);Op(this,"Custom currencies")}x(j2c,E_);p=j2c.prototype;p.LX=n(1000.12);p.Efa=function(){return new g2c("Custom currency")};p.K5=function(){var a=this;v9b();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=Vac[e]:D_c(d,Yac(d.wl()))}var f=[];hc(wt,function(b,c){b=Xac(c);a.va(b);f.push(b)});var h=rAc();tb(f,function(a,b){return h(aS(a),aS(b))});return b.concat(f)};
p.u1=function(){var a=new Ew;a.setType(4);W(a,3,1);var b=this.input.C.bf().Ma().wl();W(a,2,b);return a};p.$Va=function(){return this.input.Ta().C};function k2c(a){M.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}x(k2c,M);k2c.prototype.xa=function(){var a=N(e2c);this.F=Sd("nfd-sample-label",a);this.D=Mca("nfd-rendered-sample",a);this.Da=a};function H_(a,b){G_.call(this,a);this.C=new k2c(b);this.Dd(new bS(""))}x(H_,G_);H_.prototype.xa=function(){this.Da=N($1c,{lMa:Yh(this,"nfd-i"),mMa:this.$,tZ:Yh(this,"nfd-icwr"),wV:Yh(this,"nfd-a")})};H_.prototype.Ia=function(){H_.ma.Ia.call(this);this.Ha(this.C,!0);l2c(this)};H_.prototype.ZVa=function(){l2c(this)};H_.prototype.iM=function(a){H_.ma.iM.call(this,a);l2c(this)};
function l2c(a){var b=a.Ta();if(b){var c=a.C;a=b.wl().split(";").length-1;se(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=f7b(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.wl()),k=d<=a;L(pe(e),k);se(e,f);rh(e,"color",h||"")}d=b.Ue()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.wl()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.wl());c=c.D[3];L(pe(c),3<=a);se(c,d);rh(c,"color",b||"")}};function m2c(a){E_.call(this,a);Op(this,"Custom number formats")}x(m2c,E_);m2c.prototype.LX=n(1234.56);m2c.prototype.Efa=function(){return new H_("Custom number format",1234.56)};
m2c.prototype.K5=function(){var a=this.F;a.push(new bS("0"));a.push(new bS("0.00"));a.push(new bS("#,##0"));a.push(new bS("#,##0.00"));a.push(new bS("#,##0_);(#,##0)"));a.push(new bS("#,##0_);[Red](#,##0)"));a.push(new bS("#,##0.00_);(#,##0.00)"));a.push(new bS("#,##0.00_);[Red](#,##0.00)"));a.push(new bS("$#,##0_);($#,##0)"));a.push(new bS("$#,##0_);[Red]($#,##0)"));a.push(new bS("$#,##0.00_);($#,##0.00)"));a.push(new bS("$#,##0.00_);[Red]($#,##0.00)"));a.push(new bS("@"));a.push(new bS("0%"));a.push(new bS("0.00%"));
a.push(new bS("0.00E+00"));a.push(new bS("##0.0E+0"));a.push(new bS("# ?/?"));a.push(new bS("# ??/??"));a.push(new bS('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new bS('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new bS('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new bS('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};m2c.prototype.u1=function(){var a=new Ew;a.setType(2);W(a,3,1);var b=this.input.Ma();W(a,2,b);return a};function I_(a,b){tk.call(this,b,new n2c(a))}x(I_,tk);p=I_.prototype;p.bh=function(a,b,c){I_.ma.bh.call(this,a,b,c);a.Rb()&&this.Rb()&&a.getParent()==this&&o2c(this)};p.Ia=function(){I_.ma.Ia.call(this);o2c(this)};p.vd=function(a){I_.ma.vd.call(this,a);o2c(this)};p.removeChild=function(a,b){a=I_.ma.removeChild.call(this,a,b);o2c(this);return a};p.fn=function(a,b){a=I_.ma.fn.call(this,a,b);o2c(this);return a};
p.zj=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=jk(this);if(c){b=39==b;this.Ke()&&(b=!b);c=c.getElement();c=Sa(c.parentNode.childNodes,c);var d;(d=jk(this))?(d=d.getElement(),d=kda(d,p2c)):d=null;d=d?Sa(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=q2c(this,e);b?b=q2c(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.T$(this.Fq()+b);b=!0}else b=!1}b=!b}return b?I_.ma.zj.call(this,
a):!0};p.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function q2c(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function o2c(a){var b,c=a.Gd(),d=a.Tc(),e=kb(Rd("div",p2c,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.oa().xa("DIV",p2c),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.Tc();k++)a.dd(k)instanceof sk?(d.push(new r2c(b,k,!0)),b=k+1):a.dd(k)instanceof lk&&(0==k?h=!0:(a.dd(k-1),d.push(new r2c(b,k-1,!1)),b=k));k=a.Tc();0<d.length&&Ra(d).end!=k-1&&d.push(new r2c(b,k-1,!1));b=h;h=a.Tc();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.Tc()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else s2c(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.Tc();f++){for(;f>c[d];)++d;b=a.dd(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof sk?L(h,!1):L(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function s2c(a,b,c){function d(a){return a.end-a.start-(a.bHb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;fb(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,fb(a,l,1))}}function r2c(a,b,c){this.start=a;this.end=b;this.bHb=c}function n2c(a){rk.call(this);this.D=a}x(n2c,rk);var p2c="docs-multi-menu-col";function t2c(a){this.C=a}x(t2c,A);t2c.prototype.create=function(){return new I_(this.C)};function u2c(a,b){G_.call(this,a);this.ea=new M;this.H=new v2c;this.F=new M;a=(new t2c(3)).create();a.Ha(new lk("Date"),!0);a.Ha(new ok("Day","DAY_TOKEN"),!0);a.Ha(new ok("Month","MONTH_TOKEN"),!0);a.Ha(new ok("Year","YEAR_TOKEN"),!0);a.Ha(new lk("Time"),!0);a.Ha(new ok("Hours","HOURS_TOKEN"),!0);a.Ha(new ok("Minutes","MINUTES_TOKEN"),!0);a.Ha(new ok("Seconds","SECONDS_TOKEN"),!0);a.Ha(new ok("Milliseconds","MILLIS_TOKEN"),!0);a.Ha(new ok("AM/PM","AM_PM_TOKEN"),!0);a.Ha(new lk("Duration"),!0);a.Ha(new ok("Elapsed hours",
"ELAPSED_HOURS_TOKEN"),!0);a.Ha(new ok("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Ha(new ok("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new nGb(a);this.C=b}x(u2c,G_);p=u2c.prototype;p.xa=function(){this.Da=N(c2c,{tZ:Yh(this,"nfd-icwr"),wV:Yh(this,"nfd-a")})};
p.Ia=function(){u2c.ma.Ia.call(this);dh(this.getElement(),"nfd-date-time-input");var a=$h(this,"nfd-icwr"),b=this.ea;b.Wa(a);b.Id(this);b.Ha(this.L,!0);dh(this.L.getElement(),"nfd-date-time-menu-button");dh(this.L.xc().getElement(),"nfd-date-time-menu");ii(this.L.Da,"Add a date or time format");b.Ha(this.H,!0);Mc||dh(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Ha(a,!0);rh(a.getElement(),"display","inline");this.getHandler().R(this,"ge",Ba(this.aWa,"left")).R(this,"ke",Ba(this.nKa,"left")).R(this,
"le",Ba(this.nKa,"right")).R(this,"me",Ba(this.YKa,"left")).R(this,"ne",Ba(this.YKa,"right")).R(this,"je",Ba(this.aWa,"right")).R(this.L,"action",this.ppb)};p.DEa=function(){this.ea.getElement().focus()};
p.iM=function(a){this.Dd(a.clone());var b=this.F;b.Cd(!0);se(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.wl());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?se(this.H.getElement(),d[2]):(e=b.dd(b.Tc()-1),d=d[2],se(e.Pz.getElement(),we(e.Pz.getElement())+d)):w2c(this,e).Qa(d[1])}0<b.Tc()&&b.dd(b.Tc()-1).Vx.getElement().focus()};
p.Ma=function(){for(var a=this.H.toString(),b=0;b<this.F.Tc();b++)a+=this.F.dd(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=Ub(e,"["),e=Ub(e,"]")):c=!0}b+=e}return b};p.ppb=function(a){a=a.target.Ma();w2c(this,a).Vx.getElement().focus()};
function w2c(a,b){Z1c(a,!1);switch(b){case "DAY_TOKEN":var c=x2c(a);break;case "MONTH_TOKEN":c=y2c(a);break;case "YEAR_TOKEN":c=z2c(a);break;case "HOURS_TOKEN":c=A2c();break;case "MINUTES_TOKEN":c=B2c();break;case "SECONDS_TOKEN":c=C2c();break;case "MILLIS_TOKEN":c=D2c();break;case "AM_PM_TOKEN":c=E2c(a);break;case "ELAPSED_HOURS_TOKEN":c=F2c();break;case "ELAPSED_MINUTES_TOKEN":c=G2c();break;case "ELAPSED_SECONDS_TOKEN":c=H2c()}b=c;b.Ha(new sk,!0);b.Ha(new ok("Delete"),!0);c=new I2c(c,"");a.F.Ha(c,
!0);return c}p.aWa=function(a,b){b=b.target;if(b instanceof v2c){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.dd(ai(this.F,b)+1),!b))return}a=we(b.Pz.getElement());var c=b.getParent(),d=ai(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=we(b),se(b,c+a),J2c(this.H,c.length)):(d--,b=c.dd(d),c=we(b.Pz.getElement()),se(b.Pz.getElement(),we(b.Pz.getElement())+a),J2c(b.Pz,c.length))};
p.YKa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.dd(ai(this.F,b)+a))&&a.Vx.getElement().focus()};p.nKa=function(a,b){var c="left"==a?-1:0;(b=this.F.dd(ai(this.F,b.target)+c))||"left"!=a?b&&(b=b.Pz):b=this.H;c=we(b.getElement()).length;J2c(b,"left"==a?c:0)};function I2c(a,b){M.call(this);this.Vx=new qO("",a);this.Ha(this.Vx,!0);this.Pz=new v2c(b);this.Ha(this.Pz,!0)}x(I2c,M);p=I2c.prototype;
p.Ia=function(){I2c.ma.Ia.call(this);rh(this.getElement(),"display","inline-block");this.Vx.kf(0);this.C=new Rj(this.Vx.getElement());this.va(this.C);this.getHandler().R(this.Vx,"action",this.X1b).R(this.C,"key",this.Y1b)};p.X1b=function(){this.Vx.uH();this.Vx.bf().Ta()||this.dispatchEvent("je")};p.Y1b=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("je"));break;case 37:a.preventDefault();this.dispatchEvent("ke");break;case 39:a.preventDefault(),this.dispatchEvent("le")}};
p.toString=function(){return this.Vx.bf().Ta()+this.Pz.toString()};p.Qa=function(a){this.Vx.Qa(a)};function v2c(a){M.call(this);this.C=a||""}x(v2c,M);p=v2c.prototype;p.xa=function(){var a=Xd("SPAN");Td(a,{contentEditable:!0});se(a,this.C);var b=a.style;Ic&&!Tc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Mc?"-moz-pre-wrap":"pre-wrap";this.Da=a};
p.Ia=function(){v2c.ma.Ia.call(this);var a=new Rj(this.getElement());this.va(a);this.getHandler().R(a,"key",this.Z1b).R(this.getElement(),"paste",this.$1b)};function J2c(a,b){if(0==we(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=oM(c,b);a.getElement().focus();b.select()}}
p.Z1b=function(a){var b=ve(this.getElement()),c=eM(),d=we(this.getElement()).length,e=c?0==c.Ah()&&0==c.wn():Kb(Yb(b));b=c?c.Ah()==d&&c.wn()==d:Kb(Yb(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("ge"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("je"));break;case 40:this.dispatchEvent("he");break;case 38:this.dispatchEvent("ie");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("me"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("ne"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=Naa(we(this.getElement())).replace(/"/g,'"\\""');return 0==Yb(a).length?"":'"'+a+'"'};p.$1b=function(){var a=v(function(){se(this.getElement(),we(this.getElement()))},this);zi(a)};
function x2c(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new F_(Ba(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new F_(Ba(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new F_(Ba(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new F_(Ba(b,e),a,d));d=new tk;for(e=0;e<c.length;e++)d.Ha(c[e],!0);return d}
function y2c(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new F_(Ba(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new F_(Ba(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new F_(Ba(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new F_(Ba(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new F_(Ba(b,e),a,d));d=new tk;for(e=0;e<c.length;e++)d.Ha(c[e],!0);return d}
function z2c(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two digit year ("+(e+")");c.push(new F_(Ba(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new F_(Ba(b,e),a,d));d=new tk;for(e=0;e<c.length;e++)d.Ha(c[e],!0);return d}
function A2c(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c=new tk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function B2c(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c=new tk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function C2c(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c=new tk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function D2c(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new F_(Ba(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new F_(Ba(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new F_(Ba(a,d),e,c));c=new tk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function E2c(a){function b(a){return"AM/PM ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new F_(Ba(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new F_(Ba(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new F_(Ba(b,e),a,d));d=new tk;for(e=0;e<c.length;e++)d.Ha(c[e],!0);return d}
function F2c(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c=new tk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function G2c(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c=new tk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function H2c(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new F_(Ba(a,d),e,c));c=new tk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c};function K2c(a){E_.call(this,a);Op(this,"Custom date and time formats")}x(K2c,E_);p=K2c.prototype;p.$Sa=Je;p.LX=n(11175.5628472222);p.isEmpty=function(){return Kb(vw(this.u1(),2))};p.Ue=function(){return ritz_api.RitzModelApi.isValidFormatPattern(vw(this.u1(),2))};p.Efa=function(){return new u2c("Custom date time format",11175.5628472222)};p.u1=function(){return L2c(this.input.Ma())};
p.K5=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.LX(),c.wl());c.D=d}b=M2c(this);ob(b);for(c=0;c<b.length;c++)a.push(new bS(L2c(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.LX(),b[c])));return a};
function M2c(a){var b=lt,c=Va(b.DATEFORMATS,function(a){return N2c(a)},a),d=Va(b.TIMEFORMATS,function(a){return N2c(a)},a),e=c.concat(d);b=b.DATETIMEFORMATS;ob(b);a=Va(b,function(a){return N2c(a)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function N2c(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Mb(a.join(""))}function L2c(a){var b=new Ew;b.setType(7);W(b,3,1);W(b,2,a);return b};function O2c(a,b){this.D=a;this.C=b}O2c.prototype.getUrl=g("D");O2c.prototype.getTitle=g("C");function P2c(a,b,c,d,e,f){rs.call(this,a,b,"domain",d,e,f);this.H=c}x(P2c,rs);P2c.prototype.C=function(){var a=P2c.ma.C.call(this);a.domainName=this.H;return ic(a,nDa)};EDa.set("domain",function(a){return new P2c(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new P2c("","DEFAULT","",!0);function Q2c(){};function R2c(a){for(var b="",c=a.JTb,d=c.length,e=0;e<d;e++){var f=c[e],h=a.HTb[f.Bh()];f.getName();var k=f.getLabel();f=f.OHb;f=P('<div id="'+R(h)+'" tabindex="0" role="link" class="'+R("ess-button")+'" aria-label="'+R(k)+'"><div class="'+R("ess-icon")+" "+R(f)+'"></div></div>');b+=f}return P(b+"")};function S2c(a,b){M.call(this,b);this.D=a||[];this.F=[];this.C=null}x(S2c,M);p=S2c.prototype;p.yea=!0;p.Vda=!1;p.hP=null;p.OCa=!1;p.Pa=function(a,b){this.yea=a;this.Vda=b;if(this.OCa){b=this.oa();for(var c=0,d;d=this.D[c];c++){var e=b.getElement(this.hP.Epa+"-"+d.Bh()),f=a;hh(e,"ess-button",f);hh(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();Ui(e,f,d)}}};
p.xa=function(){this.Da=this.gb.createElement("SPAN");var a={};a.Epa=Yh(this,"service");a.JTb=this.D;this.hP=a;for(var b={},c=0,d;d=this.D[c];c++)b[d.Bh()]=this.hP.Epa+"-"+d.Bh();a.HTb=b;this.hP=a;kq(this.getElement(),R2c,this.hP);this.OCa=!0};
p.CRb=function(a){if(this.yea){if(this.C){var b={};b.externalSharingService=a.C;this.C.C(9,b)}if(this.Vda)this.dispatchEvent(new T2c(new U2c(a,this.F,this.C||void 0)));else{var c=this.C||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.C;c.C(10,d)}a={NGc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=Do(b,a))&&a.focus()}}};
p.Ia=function(){this.Pa(this.yea,this.Vda);for(var a=this.oa(),b=this.getHandler(),c=0,d;d=this.D[c];c++){var e=a.getElement(this.hP.Epa+"-"+d.Bh());b.Jg(e,gf,v(this.CRb,this,d))}};p.Fa=function(){S2c.ma.Fa.call(this);delete this.F;delete this.D;this.C=null};function T2c(a,b){D.call(this,"oe",b);this.context=a}x(T2c,D);function U2c(){}x(U2c,Q2c);function J_(a,b,c,d){this.C=a;this.F=b;this.D=c;this.OHb=d;this.H=V2c++}var V2c=0;J_.prototype.Bh=g("H");J_.prototype.getName=g("F");J_.prototype.getLabel=g("D");function W2c(){J_.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}x(W2c,J_);W2c.prototype.getUrl=function(a){var b=Va(a,function(a){return a.getTitle()});a=Va(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Ob(a.join(","))+"&t="+Ob(b.join(","))};function X2c(){J_.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}x(X2c,J_);X2c.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Ob(a[0].getUrl())};function Y2c(){J_.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}x(Y2c,J_);Y2c.prototype.getUrl=function(a){a=Va(a,function(a){return a.getTitle()+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Ob(a.join("\n"))};function Z2c(){J_.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}x(Z2c,J_);Z2c.prototype.getUrl=function(a){for(var b=pa(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].getTitle();h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Ob(a)};function K_(a){M.call(this,a)}x(K_,M);function $2c(a){a.dispatchEvent(new D("pe"))}K_.prototype.PX=function(){return{}};K_.prototype.WJ=Le;K_.prototype.xpa=sa;function a3c(a){M.call(this,a)}x(a3c,M);a3c.prototype.F=Le;a3c.prototype.H=sa;a3c.prototype.J=sa;function b3c(a,b,c){b=c||b;c="";var d="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+I_c(a.locale)+'&answer=183965">Learn more</a>');c+='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">'+d+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">Embed</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
R(a.x$a)+'" readonly="readonly" aria-label="'+Bq("Link to published document.")+" "+R(a.qQa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">Or share this link using:</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="'+
Bq("HTML embed code of published document.")+" "+R(a.qQa)+'">'+lAa(a.veb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+O(Ar({id:"pub-dialog-publish-link-button",style:2,value:a.BRb},b))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+O(vs({nt:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"},b))+'Published content & settings</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
O(Ar({id:"pub-dialog-publish-button",value:a.zRb},b))+'<div class="pub-dialog-checkbox-container">';a.uIb&&(d="Require viewers to sign in with their "+(O(a.domain)+" account"),c+=O(Hq({id:"pub-dialog-dom-signin-req",checked:a.Js,disabled:a.oJ},b))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.oJ?' class="pub-dialog-disabled-text"':"")+">"+d+"</label><br>");a.qP&&(c+=O(Hq({id:"pub-dialog-auto-publish-checkbox"},b))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">Automatically republish when changes are made</label>');
return P(c+"</div></div></div></div></div>")};function L_(a,b,c,d,e,f,h,k,l,m){fq.call(this);this.kb=a||"";this.Me=b;this.bd=c;this.Uc=d;this.Fc=l||"/publishsettings";this.C=new c3c(e);this.Ab=new S2c([new X2c,new Y2c,new W2c,new Z2c]);this.Ha(this.Ab);this.qa=new Br(null,this.oa());this.Ha(this.qa);this.ea=new Br(null,this.oa());this.Ha(this.ea);this.Ra=new Iq(void 0,this.oa());this.Ha(this.Ra);this.Ba=new Iq(void 0,this.oa());this.Ha(this.Ba);this.Sa=0;this.Nb=new d3c;this.Ha(this.Nb);this.wb=this.Bb=null;this.J=f||new K_;this.Ha(this.J);this.F=
h||new K_;this.Ha(this.F);this.Oa=k||new a3c;this.Ha(this.Oa);this.O=this.L=null;this.ib=new os(void 0,e3c,this.oa(),2);this.va(this.ib);this.De=this.ld=null;this.Se=m||new M;this.Wb=this.Ua=this.Cb=null;this.aj=!0}x(L_,fq);var e3c="Press "+((Qc?"\u2318+C":"Ctrl+C")+" to copy.");p=L_.prototype;p.show=function(){f3c(this,v(function(){this.setVisible(!0)},this))};
p.setVisible=function(a){L_.ma.setVisible.call(this,a);var b=De(this.oa());a?this.getHandler().R(b,"resize",this.ud):this.getHandler().Nc(b,"resize",this.ud)};
p.xa=function(){L_.ma.xa.call(this);var a=this.oa(),b=N(b3c,{uIb:!!this.C.domain,qP:this.C.qP(),Js:this.C.Js,domain:this.C.C,oJ:this.C.oJ,zRb:g3c(this),BRb:M_(this,h3c(this))?"Published":"Publish",x$a:this.C.Ak?i3c(this,this.J.PX()):"",veb:this.C.Ak?j3c(this,this.F.PX()):"",locale:"en",qQa:e3c});a.appendChild(this.Hb(),b);Op(this,"Publish to the web");$p(this,null);dh(this.Hb(),"pub-dialog-content")};
p.Ia=function(){var a=this.oa(),b=a.getElement("pub-dialog-sharing-services-links");this.Ab.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Cb=a.getElement("pub-dialog-links-notice");this.Se.render(this.Cb);b=a.getElement("pub-dialog-published-content");this.Oa.render(b);L_.ma.Ia.call(this);b=this.getHandler();var c=a.getElement("pub-dialog-dom-signin-req");c&&(this.Ra.Wa(c),qq(this.Ra,a.getElement("pub-dialog-dom-signin-req-label")),
b.R(this.Ra,"change",this.KWb));this.C.qP()&&(this.Ba.Wa(a.getElement("pub-dialog-auto-publish-checkbox")),qq(this.Ba,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.R(this.Ba,"change",this.GWb));this.Bb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.wb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");ms(this.ib,this.L);this.Nb.Wa(a.getElement("pub-dialog-links-tab-bar"));this.ld=a.getElement("pub-dialog-sharing-services");
this.De=a.getElement("pub-dialog-status-info");this.qa.Wa(a.getElement("pub-dialog-publish-link-button"));this.ea.Wa(a.getElement("pub-dialog-publish-button"));this.Wb=new bQ("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Ak);this.va(this.Wb);b.R(this.Nb,"select",this.iCb).R(this.L,"focus",this.QRa).R(this.O,"focus",this.QRa).R(this.ea,"action",this.DRb).R(this.getElement(),"keyup",this.J9a).R(this.J,"pe",this.lra).R(this.F,"pe",this.lra).R(this.qa,"action",this.kAb).R(this.Oa,
"qe",this.lAb).R(this.Wb,"toggle",this.ud);k3c(this)};function k3c(a){if(a.Rb()){var b=a.oa(),c=a.C.Ak,d=a.C.oJ;a.Oa.H(a.C.Dm);a.Ra.Pa(!d);a.ea.setContent(g3c(a));a.ea.Pa(a.C.Ak||!a.C.Dm||!a.C.Dm.isEmpty());a.C.qP()&&a.Ba.Bc(a.C.jw);a.lra();b=b.Ei("pub-dialog-state-publishing");z(b,function(a){L(a,c)});se(a.De,c?"This document is published to the web.":"This document is not published to the web.");a.ud()}}p.J9a=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function l3c(a,b){var c=window.location.href,d=Nk(c);c=Qk(c);var e=Sb(c,"/"+a.Uc+"/")?"/"+a.Uc:"";a.C.Js&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.F||a.kb;b=pHa.test(b)?b:gl("/d/"+a,b);return Mk(c,f,h,d,gl(e,b))}
p.lra=function(){var a=this.J.WJ();if(a=M_(this,a)){var b=this.J.PX();b=this.C.Ak?i3c(this,b):"";this.L.value=b;this.Ab.F=[new O2c(b,this.Me)]}L(this.L,a);L(this.ld,a&&!this.C.oJ);a=this.F.WJ();if(a=M_(this,a))b=this.F.PX(),this.O.value=this.C.Ak?j3c(this,b):"";L(this.O,a);a=M_(this,h3c(this));L(this.Cb,a);this.qa.Pa(!a);this.qa.setContent(M_(this,h3c(this))?"Published":"Publish")};
p.iCb=function(a){a=a.target;this.oa();ns(this.ib);"pub-dialog-link-tab"==a.getId()?(this.Sa=0,L(this.Bb,!0),L(this.wb,!1),ms(this.ib,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.Sa=1,L(this.Bb,!1),L(this.wb,!0),ms(this.ib,this.O));k3c(this)};p.QRa=function(a){zi(function(){a.target.select()},0)};p.KWb=function(){this.C.Ak?m3c(this,2,!1):this.C.Js=!this.C.Js};p.GWb=function(){this.C.Ak?m3c(this,0,!1):this.C.jw=!this.C.jw};function g3c(a){return a.C.Ak?"Stop publishing":"Start publishing"}
function f3c(a,b){Tq(a.bd.He(a.Fc).yf("id",a.kb),v(function(a){this.C.Ak=!!vu(a,"published");this.C.Js=!!vu(a,"requireSignin");this.C.oJ=!!vu(a,"domainClosed");this.C.domain=B_c(a,"domain");this.C.C=B_c(a,"domainDisplay");var c=this.C;var e=Number(vu(a,"revision"));c.jw=!e;this.C.Dm=this.fGa(a.Te());this.C.F=B_c(a,"publishedDocumentId");b()},a)).le()}p.fGa=Le;p.MFa=Le;function n3c(a){return{jw:a.C.jw,Ak:a.C.Ak,Js:a.C.Js,Dm:a.C.Dm}}
function m3c(a,b,c){c=t(c)?c:!0;var d=n3c(a);switch(b){case 0:d.jw=!d.jw;break;case 1:d.Ak=!d.Ak;break;case 2:d.Js=!d.Js;break;default:throw Error("Unknown toggle op: "+b);}d.Ak||(d.Dm=a.MFa());o3c(a,d,c)}
function o3c(a,b,c){p3c(a,!1);bu(Tq(cu(Uq(a.bd.He(a.Fc).yf("id",a.kb),q3c(a,b)),2),v(function(){this.C.jw=b.jw;this.C.Ak=b.Ak;this.C.Js=b.Js;this.C.Dm=b.Dm;this.C.Ak&&this.C.Dm&&(M_(this,this.J.WJ())||this.J.xpa(this.C.Dm),M_(this,this.F.WJ())||this.F.xpa(this.C.Dm));p3c(this,!0);k3c(this);if(c&&this.C.Ak)switch(this.Sa){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.Sa);}},a)),v(function(){cBa("An error occurred while saving publishing settings.",
void 0,this.Rb()?this:void 0);p3c(this,!0);k3c(this)},a)).le()}function q3c(a,b){var c={id:a.kb,requireSignin:b.Js,published:b.Ak};a.C.qP()&&!b.jw&&(c.revision=a.C.D);b.Dm&&(a=r3c(b.Dm),Cc(c,a));return c}function p3c(a,b){for(var c=[a.Ba,a.ea,a.qa,a.Ra],d=0;d<c.length;d++){var e=c[d];!b&&e.uo()&&(a.Ua=e);e.Pa(b)}b&&a.Ua&&(a.isVisible()&&a.Ua.isVisible()&&(c=a.Ua.getElement())&&c.focus(),a.Ua=null);a.Oa.J(b)}
p.DRb=function(a,b){if(b||window.confirm(this.C.Ak?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.ea.setContent("Saving..."),m3c(this,1)};function h3c(a){switch(a.Sa){case 0:return a.J.WJ();case 1:return a.F.WJ();default:throw Error("Cannot handle selected link type "+a.Sa);}}
p.kAb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=h3c(this),b=n3c(this);b.Ak=!0;a&&(b.Dm&&this.C.Ak?b.Dm=s3c(b.Dm,a):b.Dm=a);this.qa.setContent("Publishing...");o3c(this,b,!0)}};p.lAb=function(){var a=this.Oa.F();if(this.C.Ak)if(a&&a.isEmpty())m3c(this,1);else{var b=n3c(this);b.Dm=a;o3c(this,b)}else this.C.Dm=a,k3c(this)};function M_(a,b){var c;(c=a.C.Ak)&&!(c=!b||!a.C.Dm)&&(a=a.C.Dm,c=a.F||!b.F&&Ya(b.D.Ad(),a.v8,a)&&Ya(b.C,a.j8,a));return c}
function c3c(a){this.D=a;this.oJ=this.Js=this.Ak=!1;this.jw=!0;this.F=this.C=this.domain=""}c3c.prototype.qP=function(){return!!this.D};function d3c(){qV.call(this)}x(d3c,qV);d3c.prototype.zj=function(a){return a.keyCode&&27==a.keyCode?!1:d3c.ma.zj.call(this,a)};function t3c(a){a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+I_c(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return P(""+('<div class="pub-dialog-chart-notice">'+a+"</div>"))};function u3c(a,b,c,d){this.F=a;this.Vg=b;this.C=c;this.D=d}function v3c(a,b){return new u3c(!1,null,new w3c(a,b||"interactive"),null)}function w3c(a,b){this.id=a;this.format=b};function N_(a,b,c){this.F=a;this.D=new pr(b);this.C=c}p=N_.prototype;p.v8=function(a){return this.F||this.D.contains(a)};function x3c(a,b){return Xa(a.C,function(a){return a.id==b.id})}p.j8=function(a){return this.F||this.D.contains(a.Vg)||x3c(this,a)};function y3c(a,b){a.C=Ua(a.C,function(a){return a.Vg!=b})}function z3c(a,b){x3c(a,b)&&(a.C=Ua(a.C,function(a){return a.id!=b.id}))}
function s3c(a,b){var c=a.F||b.F;if(c)return new N_(c,[],[]);var d=a.clone();z(b.D.Ad(),function(a){d.D.contains(a)||(d.D.add(a),y3c(d,a))});z(b.C,function(a){d.j8(a)||d.C.push(a)});return d}function r3c(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.Ad().join(","),charts:Va(a.C,function(a){return a.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&bb(this.C)};p.clone=function(){return new N_(this.F,this.D.Ad(),kb(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&xb(this.C,a.C,function(a,c){return a.id==c.id&&a.Vg==c.Vg})};function A3c(a,b){this.id=a;this.Vg=b};function B3c(a,b,c,d){M.call(this,void 0);this.C=c||new u3c(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new qO("",C3c(a,b));TR(this.D,!0);this.Ha(this.D,!0);a=new tk;a.Ha(new ok("Interactive","interactive"),!0);a.Ha(new ok("Image","image"),!0);this.H=new qO("",a);this.Ha(this.H,!0);a=new tk;a.Ha(new ok("Web page","html"),!0);a.Ha(new ok("Comma-separated values (.csv)","csv"),!0);a.Ha(new ok("Tab-separated values (.tsv)","tsv"),!0);a.Ha(new ok("PDF document (.pdf)","pdf"),!0);a.Ha(new ok("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Ha(new ok("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new qO("",a);this.Ha(this.F,!0);D3c(this)}x(B3c,K_);var E3c=["xlsx","ods"],F3c=["csv","tsv"];
function C3c(a,b){var c=new tk;c.Ha(new ok("Entire Document",new G3c("entireDocument",null)),!0);c.Ha(new sk,!0);var d=Enb(b);z(a.D,function(a){c.Ha(new ok(a.Vd(),new G3c("sheet",a.yb())),!0);if(a=d[a.yb()])for(var b={},e=0;e<a.length;b={GV:b.GV},e++){var k=a[e];6==k.getType()&&k.isSaved()&&(b.GV=new ok("",new G3c("chart",PJ(k))),mnb(k).then(function(a){return function(b){a.GV.hn(b.getTitle())}}(b)),c.Ha(b.GV,!0),dh(b.GV.Hb(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=B3c.prototype;
p.Ia=function(){B3c.ma.Ia.call(this);dh(this.getElement(),"pub-dialog-link-options-container");dh(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");dh(this.D.Hb(),"pub-dialog-link-options-document-part-menu-button-content");dh(this.D.xc().getElement(),"pub-dialog-link-options-document-part-menu");ii(this.D.Da,"Sheet or chart selection");ii(this.H.Da,"Chart format");ii(this.F.Da,"Sheet format");this.getHandler().R(this.D,"change",this.oqb).R(this.H,"change",this.hnb).R(this.F,
"change",this.TCb).R(this.D,"afterhide",function(a){a.stopPropagation()}).R(this.H,"afterhide",function(a){a.stopPropagation()}).R(this.F,"afterhide",function(a){a.stopPropagation()})};p.oqb=function(){var a=this.D.bf().Ta();switch(a.type){case "entireDocument":this.C=new u3c(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id;var b=this.C.D;b&&!H3c(this,a,b)&&(b=null);this.C=new u3c(!1,a,null,b||"html");break;case "chart":this.C=v3c(a.id,this.C.C?this.C.C.format:null)}D3c(this);$2c(this)};
p.hnb=function(){var a=this.H.bf().Ta();this.C.C&&(this.C.C.format=a,$2c(this))};p.TCb=function(){var a=this.F.bf().Ta();this.C.D=a;$2c(this)};
function D3c(a){var b=kb(a.D.Hj.C);b=Za(b,function(a){a=a.Ta();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.Vg&&a.id==this.C.Vg;case "chart":return null!=this.C.C&&a.id==this.C.C.id;default:return!1}},a);Qr(a.D,b);b=!!a.C.C;L(a.H.getElement(),b);null!=a.C.C&&a.H.Qa(a.C.C.format);L(a.F.getElement(),a.J&&!b);b||(I3c(a),a.F.Qa(a.C.D))}
function I3c(a){for(var b=a.F.xc(),c=0;c<b.Yi();c++){var d=b.ef(c),e=d.Ma();d.Pa(null==a.C.Vg||H3c(a,a.C.Vg,e))}}function H3c(a,b,c){if(ab(E3c,c))return!1;a=LG(a.O,b);return null!=a&&1==a.getSheetType()&&ab(F3c,c)?!1:!0}p.PX=g("C");p.WJ=function(){if(this.C.F)return new N_(!0,[],[]);if(null!=this.C.Vg)return new N_(!1,[this.C.Vg],[]);var a=this.L.C(this.C.C.id);a=new A3c(this.C.C.id,a.yb());return new N_(!1,[],[a])};
p.xpa=function(a){if(!a.F){var b=a.D.Ad();0<b.length?this.C=new u3c(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=v3c(a[0].id)));D3c(this)}};function G3c(a,b){this.type=a;this.id=b};function O_(a,b){Gr.call(this,void 0,void 0,new pO,void 0);this.Ba=a;this.ea=b;this.F=new N_(!0,[],[]);this.V=!1;this.H=new $P("Entire Document");this.Jd(this.H);this.Jd(new sk);J3c(this);TR(this,!0);K3c(this)}x(O_,Gr);
function J3c(a){var b=Enb(a.ea);z(a.Ba.D,function(c){var d=new $P(c.Vd(),c);a.Jd(d);(c=b[c.yb()])&&z(c,function(b){if(6==b.getType()&&b.isSaved()){var c=new $P("",b);mnb(b).then(function(a){c.hn(a.getTitle())});a.Jd(c);dh(c.Hb(),"pub-dialog-published-content-chart-menu-item")}})})}
O_.prototype.Ia=function(){O_.ma.Ia.call(this);dh(this.getElement(),"pub-dialog-published-content-menu-button");dh(this.Hb(),"pub-dialog-published-content-menu-button-content");dh(this.xc().getElement(),"pub-dialog-published-content-menu");this.getHandler().R(this,"afterhide",function(a){a.stopPropagation()})};
O_.prototype.vs=function(a){if(a.target==this.H){a=this.H.isChecked();var b=this.F;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.Ta(),b instanceof eF?(b=b.yb(),a?(a=this.F,a.D.contains(b)||(a.D.add(b),y3c(a,b))):(a=this.F,a.D.contains(b)&&(a.D.remove(b),y3c(a,b)))):(b=new A3c(PJ(b),b.yb()),a?(a=this.F,a.j8(b)||a.C.push(b)):z3c(this.F,b));this.V=!0;K3c(this)};O_.prototype.Yd=function(a,b){O_.ma.Yd.call(this,a,b);!a&&this.V&&(this.V=!1,this.dispatchEvent(new D("qe")))};
function K3c(a){var b=a.F.F;a.H.Bc(b);z(Oqc(a.xc()),function(c){var d=c.Ta();d&&(d instanceof eF?(c.Bc(a.F.v8(d.yb())),c.Pa(!b)):(d=new A3c(PJ(d),d.yb()),c.Bc(a.F.j8(d)),c.Pa(!a.F.v8(d.Vg))))});L3c(a)}
function L3c(a){if(a.F.F)a.setContent("Entire Document");else{var b=Ua(a.Ba.D,v(function(a){return this.F.v8(a.yb())},a)),c=Va(b,function(a){return a.Vd()});b=[];for(var d=a.F.C,e=0;e<d.length;e++){var f=a.ea.C(d[e].id);f&&b.push(mnb(f))}Wia(b).then(function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];f.PEa&&d.push(f.value.getTitle())}b=jb(c,d);b=0<b.length?b.join(", "):"None";a.setContent(b)})}};function P_(a,b){M.call(this,void 0);this.C=new O_(a,b);this.Ha(this.C,!0);this.D=!1}x(P_,a3c);P_.prototype.Ia=function(){P_.ma.Ia.call(this);dh(this.getElement(),"pub-dialog-published-content-container")};P_.prototype.F=function(){return this.C.F};P_.prototype.H=function(a){var b=this.C;b.F=a.clone();K3c(b)};P_.prototype.J=function(a){!a&&this.C.uo()&&(this.D=!0);this.C.Pa(a);a&&this.D&&(this.Rb()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function M3c(a,b,c,d,e,f,h){var k=null!=h?v3c(h):null;h=new B3c(c,d,k,!0);k=new B3c(c,d,k,!1);L_.call(this,a,b,e,H0a,f,h,k,new P_(c,d),"/publishingsettings",new N3c);this.uf=c;this.kc=d}x(M3c,L_);
M3c.prototype.fGa=function(a){if(a.entireDocument)return new N_(!0,[],[]);var b=a.charts||"";a=Va((a.sheets||"").split(","),function(a){return parseInt(a,10)});a=Ua(a,function(a){return null!=LG(this.uf,a)},this);b=Va(b.split(","),function(a){return parseInt(a,10)});b=Ua(b,v(function(a){return!!this.kc.C(a)},this));b=Va(b,function(a){var b=this.kc.C(a);return new A3c(a,b.yb())},this);return new N_(!1,a,b)};M3c.prototype.MFa=function(){return new N_(!0,[],[])};
function i3c(a,b){if(b.F||null!=b.Vg){var c="html"==b.D;a=l3c(a,c?"/pubhtml":"/pub");null!=b.Vg&&(a=Uk(a,"gid",b.Vg,"single","true"));c||(a=Uk(a,"output",b.D))}else a=Uk(l3c(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function j3c(a,b){var c=i3c(a,b);if(b.F||null!=b.Vg)c=Uk(c,"widget","true","headers","false");a=b.C?(a=a.kc.C(b.C.id))?a.fd():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Qb(c)+'"></iframe>'}function N3c(){}x(N3c,M);N3c.prototype.xa=function(){this.Da=N(t3c,{locale:"en"})};function O3c(){A.call(this)}x(O3c,xB);p=O3c.prototype;p.Efb=function(){return N1c};p.Yfb=function(){return i1c};p.YLb=function(a,b,c,d){var e=new Sq;a=new Oq(a,b,c,d,void 0,!0,void 0);Pq(a,"ok");b=v(e.Wa,e);a.Sla=b;a.va(e);a.aj=!0;a.G6=xda(Kb);return a};p.Ihb=function(){return b1c};p.Y6a=function(a,b,c,d,e,f){return new H1c(a,b,c,d,e,f,void 0)};p.ggb=function(){return t0c};p.BFa=function(){return G0c};p.wgb=function(){return Q0c};p.Nhb=function(){return D_};p.Mhb=function(){return M3c};p.thb=function(){return P1c};
p.Lhb=function(){return l1c};p.bgb=function(){return m2c};p.Jhb=function(){return j2c};p.Khb=function(){return K2c};p.agb=function(){return t_};JB("dialogs",O3c);
