eg.prototype.cQ=NR(11,function(){return F(this,56)});function RVd(a,b){var c=new mX,d;for(d in a.C)d in b.C||(c.C[d]=null);return c}var SVd=[5];function TVd(a){Sf(this,a,0,-1,SVd,null)}x(TVd,Rf);TVd.prototype.getContext=function(){return F(this,1)};TVd.prototype.setContext=function(a){G(this,1,a)};TVd.prototype.Pu=function(){G(this,1,void 0)};
function UVd(a){return P("<div"+(a.id?' id="'+R(a.id)+'"':"")+' class="'+(a.Uf?R(a.Uf)+" ":"")+R("goog-flat-menu-button")+" "+R("goog-flat-menu-button-disabled")+" "+R("goog-inline-block")+'" role="button"'+(a.Rn?' aria-label="'+R(a.Rn)+'"':"")+'><div class="'+R("goog-flat-menu-button-caption")+" "+R("goog-inline-block")+'">'+O(a.$A)+'</div><div class="'+R("goog-flat-menu-button-dropdown")+" "+R("goog-inline-block")+'" aria-hidden="true">&nbsp;</div>'+(a.Tk?O(a.Tk):"")+"</div>")}
function VVd(a,b,c){b=c||b;a=a||{};return P(rEa(vq({nW:xq("docs-icon-close-small")},a),b))}function WVd(a,b){Is.call(this);this.C=a;this.D[a]=b}x(WVd,Is);WVd.prototype.Kl=function(a){var b={};b[this.C]=a;Ks(this,b)};function Y5(){Zr.call(this);this.C=new mX;$r(this,new ds(Yr,{},{wordList:[]}));this.J=new wm;this.va(this.J)}x(Y5,Zr);ta(Y5);Y5.prototype.F=function(a){XVd(this,a,!0)};function XVd(a,b,c){var d=a.C.contains(b.toLowerCase()),e=b.toLowerCase();a.C.add(e);if(!d){var f={};f.value=e;as(a).get("wordList").push(f);c&&YVd(a,[b],[])}return!d}Y5.prototype.L=function(a){ZVd(this,a,!0)};
function ZVd(a,b,c){var d=a.C.contains(b.toLowerCase());if(d){var e=b.toLowerCase();a.C.remove(e);for(var f=as(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&YVd(a,[],[b])}return d}Y5.prototype.H=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)XVd(this,a[b].value,!1);a.length&&this.J.dispatchEvent(null)};function YVd(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.J.dispatchEvent(null);a.D.dispatchEvent(new cs(new bs("docs-user_dictionary",d),as(a)))};function $Vd(a,b,c){fq.call(this,a,b,c);Op(this,"Preferences")}x($Vd,fq);p=$Vd.prototype;p.Ia=function(){$Vd.ma.Ia.call(this);this.getHandler().R(this,"dialogselect",this.r8a)};p.setVisible=function(a){$Vd.ma.setVisible.call(this,a);a&&this.update()};p.update=sa;p.r8a=function(a){"ok"==a.key&&this.GRa()};p.GRa=sa;function aWd(a){a='<b>"'+(O(a.NT)+'"</b> added to your personal dictionary.');return P(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}function bWd(a){a='<b>"'+(O(a.NT)+'"</b> removed from your personal dictionary.');return P(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}
function cWd(a,b,c){b=c||b;a=""+('<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input '+R("jfk-textinput")+'" type="text" aria-label="'+R(a.kMa)+'" placeholder="'+R(a.kMa)+'"></div><div class="docs-userdictionarydialog-button-add-container">'+O(Ar({Od:"docs-userdictionarydialog-button-add",style:0,content:yq("Add")},b))+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>');
return P(a)}function dWd(a){return P('<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+R(a.NT)+'" class="docs-userdictionarydialog-row-content">'+O(a.NT)+"</div></div>")};function Z5(a,b){Wj.call(this,void 0,new eWd);this.hsa=a;this.C=b}x(Z5,Wj);Z5.prototype.ym=ba();Z5.prototype.$B=function(a){a.relatedTarget&&qe(this.C,a.relatedTarget)||Z5.ma.$B.call(this,a)};Z5.prototype.Xh=function(a){return(46==a.keyCode||8==a.keyCode)&&this.uh(a)};function eWd(){}x(eWd,ji);eWd.prototype.hc=n("docs-userdictionarydialog-row-container");eWd.prototype.xa=function(a){return N(dWd,{NT:a.hsa})};function $5(a){fk.call(this,void 0,new fWd);this.D=a;this.C=this.F=null}x($5,fk);p=$5.prototype;p.Ia=function(){$5.ma.Ia.call(this);ii(this.Da,"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");di(this.Da,"listbox");var a=this.F;L(a,!1);Rh(a,!0);this.C=new Rj(a);this.getHandler().R(this,"action",this.loa).R(this.F,"click",this.loa).R(this.C,"key",this.Bmb)};p.jd=function(){$5.ma.jd.call(this);C(this.C);this.C=null};
function gWd(a){var b=[];a.jf(function(a){b.push(a.hsa)});return b}p.loa=function(){var a=jk(this);var b=this.Fq()==this.Tc()-1;this.highlightPrevious();this.removeChild(a,!0);b||this.highlightNext();hWd(this);this.dispatchEvent("change")};p.Bmb=function(a){return 13==a.keyCode||32==a.keyCode?(this.loa(a),a.preventDefault(),a.stopPropagation(),!0):!1};p.Xw=function(){0==this.Ei("docs-userdictionarydialog-row-container-hover").length&&kk(this)};p.Zo=function(a){a.stopPropagation();a.preventDefault()};
p.zj=function(a){return 27==a.keyCode?!1:$5.ma.zj.call(this,a)};p.cY=function(a){$5.ma.cY.call(this,a);hWd(this)};p.lja=function(a){var b=ze(document);$5.ma.lja.call(this,a);b&&ch(b,"docs-userdictionarydialog-list-remove-button")?this.Da.focus():hWd(this)};function hWd(a){if(jk(a)){var b=jk(a),c=Math.round((Lh(b.Da).height-Lh(a.F).height)/2);a.F.style.top=yh(b.Da).y+c+"px";ii(a.F,"Remove "+b.hsa);L(a.F,!0)}else L(a.F,!1)}function fWd(){this.C=void 0}x(fWd,Vj);
fWd.prototype.jp=function(a){var b=N(VVd,{enabled:!0,Uf:"docs-userdictionarydialog-list-remove-button"});a.F=b;a.getElement().appendChild(b)};function a6(a,b,c,d){$Vd.call(this,b,c,d);this.ea=a;this.F=new Br(null,d);this.Ha(this.F);this.L=this.C=null;this.J=new $5(a);this.Ha(this.J);this.O=null;Op(this,"Personal dictionary");a=bq((new Xp).set("ok","Save",!0),eq,!1,!0);$p(this,a)}x(a6,$Vd);p=a6.prototype;p.xa=function(){a6.ma.xa.call(this);kq(this.Hb(),cWd,{kMa:"Add a new word"});Pq(this,"ok");this.F.Wa(this.La("docs-userdictionarydialog-button-add"));this.J.Wa(this.La("docs-userdictionarydialog-list-container"));this.C=this.La("docs-userdictionarydialog-input")};
p.Ia=function(){a6.ma.Ia.call(this);this.F.Pa(!1);this.L=new Rq(this.C);this.getHandler().R(this.F,"action",this.Hkb).R(this.C,"keypress",this.T9a).R(this.L,"input",this.S9a).R(this.J,"change",this.Opb);this.getHandler().R(this.F.getElement(),"focus",this.Rga).R(this.C,"focus",this.Rga);for(var a=Eza(this.D),b=0;b<a.length;b++)this.getHandler().R(a[b],"focus",this.Rga);this.O=new tM(this.J)};p.jd=function(){a6.ma.jd.call(this);Db(this.L,this.O);this.O=this.L=null};p.Hkb=function(){iWd(this)};
p.S9a=function(){this.F.Pa(!Kb(Yb(this.C.value)))};p.T9a=function(a){13==a.keyCode&&(this.F.isEnabled()&&iWd(this),a.stopPropagation(),a.preventDefault())};p.Rga=function(){this.J.ag(-1)};p.Opb=function(){aq(this.D,"ok").disabled=!1};p.update=function(){var a=this.J;a.Cd(!0);var b=a.D.C.Ad();b.sort(rAc());for(var c=0;c<b.length;c++)a.Ha(new Z5(b[c],a.F),!0);jWd(this,"");aq(this.D,"ok").disabled=!0};
p.GRa=function(){var a=this.J;var b=new mX(a.D.C.Ad());var c=new mX(gWd(a));a=RVd(c,b).Ad();b=RVd(b,c).Ad();c=this.ea;for(var d=[],e=[],f=0;f<a.length;f++)XVd(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)ZVd(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&YVd(c,d,e)};
p.setVisible=function(a){a6.ma.setVisible.call(this,a);if(a){var b=this.C;b&&(b.focus(),a=b.value.length,OEa(b)?(b.selectionStart=a,b.selectionEnd=a):Ic&&!Tc("9")&&(a=QEa(b,a),b=b.createTextRange(),b.collapse(!0),b.move("character",a),b.select()))}};function jWd(a,b,c){a.C.value=b;a.F.Pa(!Kb(Yb(a.C.value)));c&&a.C.select()}
function iWd(a){var b=a.J,c=a.C.value;c=c.toLowerCase().trim();-1==gWd(b).indexOf(c)&&(c=new Z5(c,b.F),b.bh(c,0,!0),b.Da.scrollTop=0,b.dispatchEvent("change"));He(a.oa())==a.C&&a.C.blur();jWd(a,"");a.C.focus()};function kWd(a,b,c){a.setVisible(!0);b().setVisible(!1);c&&jWd(a,c,!0)};function lWd(){A.call(this);this.C=new pr;this.D=new wm;this.va(this.D)}x(lWd,A);function mWd(){}mWd.prototype.get=Le;function nWd(a,b){this.C=a;this.D=b}nWd.prototype.equals=function(a){return this.C.equals(a.C)&&this.D.equals(a.getSelection())};nWd.prototype.getSelection=g("D");function oWd(a,b){this.D=a;this.C=b};function pWd(a,b,c){this.C=a;this.F=b;this.D=c||null}pWd.prototype.ov=g("F");function qWd(a,b,c,d,e,f){this.F=a;this.L=b;this.C=c;this.D=d;this.H=e;this.J=f||null;this.Ka=new K(this);this.va(this.Ka)}x(qWd,A);p=qWd.prototype;p.R9a=function(a){var b=this.C.C;rWd(this.D,a);sWd(this,b,!0)};
p.Xmb=function(a){var b=this.C.C,c=this.D,d=Vb(a.C.ov()),e=a.D;a=new kF;W(a,1,"\\b"+d+"\\b");W(a,3,e);W(a,6,!1);W(a,7,!1);W(a,8,!0);a.setType(2);W(a,11,0);d=c.C.F;switch(c.C.V){case "RANGE":W(a,5,0);a.setSelection(bB(d.rect,d.kd));var f=zI(c.D,d.kd);break;case "SHEET":W(a,5,1);f=new Pw;W(f,1,""+d.kd);a.setSelection(f);f=zI(c.D,d.kd);break;case "WORKBOOK":W(a,5,2),f=c.D.D5(-1,0,!1)}f=f.Jc();c.F.C(new fX(f,a));sWd(this,b,!0)};
p.Otb=function(a){var b=this.C.C;if(ma(a)){var c=this.L;c.C.contains(a.toLowerCase())||(c.C.add(a.toLowerCase()),c.D.dispatchEvent(null))}sWd(this,b,!1)};p.Gob=function(a){var b=this.C.C;if(a instanceof nWd){var c=this.D.H,d=a.C.ov();a=a.getSelection();if(!tWd(c,d,a)){var e=c.C[""+a.C];e||(e=LG(c.F,a.C),e.getSheetType(),e=e.Jc(),e=new JI(e,!0),c.C[""+a.C]=e);c=a.yd.y;a=a.yd.x;var f=e.ef(c,a);f||(f=new pr,mhb(e,c,a,f));f.add(d.toLowerCase())}}sWd(this,b,!1)};
p.Hyb=function(a){var b=this.C.C;ma(a)&&(this.J?this.J.F(a):Y5.getInstance().F(a));sWd(this,b,!1)};p.ACa=function(){J.Zca.Lc(!1);this.Ka.Nc(this.F,"docs-text-spellcheckdialogcontroller-closed",this.ACa);uWd(this.D.C)};p.NLb=function(){sWd(this,null,!1)};p.aKa=function(a){var b=this.F.C;L(b.Ba,!1);L(b.Ga,!0);b=this.C;var c=v(this.aVa,this,this.C.C,!1);this.H.C.getSelection();b.C&&(a?b.L.unshift(b.C):b.ea.push(b.C));vWd(b,c,!!a)};
function sWd(a,b,c){var d=a.F.C;L(d.Ba,!1);L(d.Ga,!0);b=v(a.aVa,a,b,c);a.H.C.getSelection();vWd(a.C,b,!1)}
p.aVa=function(a,b){a=this.F;a.C.setVisible(!0);var c=a.C;L(c.Ba,!0);L(c.Ga,!1);c=a.C;var d=c.J.C;Ai(c.ib);var e=c.oa().xb("docs-slidingdialog-content",c.getElement());e&&ei(e,"label",d?"Spellcheck":"No spelling suggestions");if(d){e=d.C;var f=c.oa();c.getHandler().Nc(c.F,"focus",c.BKa).Nc(c.F,"blur",c.AKa).Nc(c.O,"input",c.DKa).Nc(c.F,"keydown",c.CKa);c.H.Qa("");var h=c.F,k=h.cloneNode(!0);je(k,h);c.F=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!c.F)throw Error("Replacement input not in DOM.");
C(c.removeChild(c.H));c.H=new yS("",f);c.Ha(c.H);c.H.Wa(c.F);C(c.O);c.O=new Rq(c.F);for(c.getHandler().R(c.F,"focus",c.BKa).R(c.F,"blur",c.AKa).R(c.O,"input",c.DKa).R(c.F,"keydown",c.CKa);0<c.D.Tc();)c.D.fn(0).dispose();f="Next misspelling. Change "+(e.ov()+" to:");ei(c.F,"label",f);c.oa().Je(c.bd,e.ov());f=pc(e.C);if(0==f.length)c.H.Qa(e.ov()),e=new ok("No suggestions"),c.D.Ha(e,!0),e.Ze(2,!1),e.Pa(!1),c.Wb.Kl(!1);else{c.H.Qa(f[0]);for(h=0;h<f.length;h++)e=new ok(f[h]),c.D.Ha(e,!0),c.getHandler().R(e,
"action",c.VFb).R(e.getElement(),"dblclick",c.cwb),1<f.length&&(e.$o(!0),dh(Sd("goog-menuitem-checkbox",e.Da),"goog-inline-block"));(e=c.D.dd(0))&&1<c.D.Tc()&&e.Bc(!0);c.D.ag(0);c.Wb.Kl(!0)}xAc(c.Na,d.getSelection());c.MUa.call(c,c.ea);c.MUa.call(c,c.Ra);L(c.Ua,!1);L(c.Sa,!0)}else L(c.Sa,!1),fe(c.Nb),c.Cb&&c.Nb.appendChild(c.Cb),L(c.Ua,!0),c.ib=zi(v(c.Sq,c),c.kc),c.Na.Pu();a.C.focus();(a=this.C.C)?wWd(this.D,a.getSelection()):b&&wWd(this.D)};function xWd(a,b){this.C=a;this.D=b}var yWd=Ec(J.A0a.getId(),J.VZa.getId(),J.gN.getId(),J.nU.getId(),J.hU.getId()),zWd=Ec(J.JXa.getId(),J.pN.getId());function AWd(a,b,c,d,e,f,h){kX.call(this,h);this.L=a;this.J=b;this.ld=new xWd(e,f);this.Na=new wAc(c);this.Ha(this.Na);this.$=new Br(null,h);this.Ha(this.$);this.ea=new tk(h);this.kb=null;this.Fc=new Ir(null,this.ea,pO.getInstance());this.Ha(this.Fc);this.Oa=new Br(null,h);this.Ha(this.Oa);this.Ra=new tk(h);this.Bb=null;this.Uc=new Ir(null,this.Ra,pO.getInstance());this.Ha(this.Uc);this.wb=this.qa=this.V=null;this.H=new yS("",h);this.Ha(this.H);this.D=new BWd(h);uk(this.D,!1);this.Ha(this.D);this.Cb=
this.Nb=this.Ua=this.Sa=this.O=this.F=null;this.kc=5E3;this.ib=this.bd=null;this.Wb=d;this.Ba=this.Ga=this.Ja=null}x(AWd,kX);function CWd(a){eh(a.Da,["goog-menu-no-icon","goog-menu-noaccel"])}p=AWd.prototype;
p.Zga=function(){var a=xq("Spellcheck");var b=""+('<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+O(zAc())+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><div class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:</div><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false">'+O(yAc({id:"docs-spellcheckslidingdialog-replacement-context"}))+
"</td><td>"+O(Ar({id:"docs-spellcheckslidingdialog-button-change",style:2,Od:"docs-spellcheckslidingdialog-buttons-action",content:yq("Change")},void 0))+O(UVd({id:"docs-spellcheckslidingdialog-button-change-menu",$A:""}))+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">'+O(Ar({id:"docs-spellcheckslidingdialog-button-ignore",style:0,Od:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",
content:yq("Ignore")},void 0))+O(UVd({id:"docs-spellcheckslidingdialog-button-ignore-menu",Uf:"docs-spellcheckslidingdialog-buttons-white-menu",$A:""}))+"<br/>"+O(Ar({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,Od:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",content:yq("Add to Dictionary")},void 0))+O(UVd({id:"docs-spellcheckslidingdialog-button-dictionary-menu",Uf:"docs-spellcheckslidingdialog-buttons-white-menu",$A:""}))+"</td></tr></tbody></table></div></div></div>");
b=P(b);a=""+(""+O(AAc({eBa:a,Jk:yq(""+b)}))+"");return P(a)};p.s5=function(a){var b=this.ld,c=this.J.C,d=new eg,e=c?c.C.cQ():null,f=b.C.C.replace(/_/g,"-");Vg(I(),"docs-anddc")||Vg(I(),"docs-agdc");Kb(Yb(e))||G(d,56,e);G(d,60,f);if(c){e=c.C;var h,k;pc(e.C).length&&(h=pc(e.C)[0]);h&&(k=e.C[h]);h=new TVd;k&&(G(h,5,k.C||[]),G(h,8,0),G(h,7,0));if(b=b.D.get(c))yWd[a]?(a=b.C-b.D,G(h,9,b.D)):zWd[a]?a=b.C:(a=a==J.q1a.getId()?b.C+1:b.C-1,G(h,9,1)),G(h,6,a);Yf(d,66,h)}return oj(nj(new jj,1),d).build()};
p.xa=function(){AWd.ma.xa.call(this);var a=Xd("SPAN","docs-spellcheckslidingdialog-menu-text","Change all"),b=Xd("SPAN","docs-spellcheckslidingdialog-count","");this.kb=new ok([a,b]);this.ea.Ha(this.kb,!0);a=Xd("SPAN","docs-spellcheckslidingdialog-menu-text","Ignore all");b=Xd("SPAN","docs-spellcheckslidingdialog-count","");this.Bb=new ok([a,b]);this.Ra.Ha(this.Bb,!0)};
p.Ia=function(){AWd.ma.Ia.call(this);dh(this.Da,"docs-spellcheckslidingdialog");var a=this.oa();this.Ga=a.getElement("docs-spellcheckslidingdialog-loading");this.Ba=a.getElement("docs-spellcheckslidingdialog-content");this.Ua=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.Nb=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.Sa=a.getElement("docs-spellcheckslidingdialog-misspellings");this.F=a.getElement("docs-spellcheckslidingdialog-replacement-input");this.O=
new Rq(this.F);this.bd=a.getElement("docs-spellcheckslidingdialog-original-word");this.Na.Wa(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.H.Wa(this.F);this.$.Wa(a.getElement("docs-spellcheckslidingdialog-button-change"));this.Oa.Wa(a.getElement("docs-spellcheckslidingdialog-button-ignore"));DWd(this.Fc,this.$,"docs-spellcheckslidingdialog-button-change-menu",J.cda,this.L,a);DWd(this.Uc,this.Oa,"docs-spellcheckslidingdialog-button-ignore-menu",J.eda,this.L,a);this.D.Wa(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
this.D.vh(!0);CWd(this.D);aj(this.L,this.Oa,J.gU,cj,v(this.J.Ja,this.J),v(this.s5,this,J.gU.getId()));aj(this.L,this.$,J.hN,cj,v(this.Uhb,this),v(this.s5,this,J.hN.getId()));this.V=new Br(null,this.oa());this.qa=new tk(a);this.wb=new Ir(null,this.qa,pO.getInstance(),a);this.Ha(this.V);this.Ha(this.wb);this.V.Wa(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));EWd(this,this.V,J.nU,!0);DWd(this.wb,this.V,"docs-spellcheckslidingdialog-button-dictionary-menu",J.dda,this.L,a);a=new ok("View personal dictionary...");
var b=zc(cj);delete b["node-label"];delete b.label;aj(this.L,a,J.sy,b,v(this.l5,this,this.J));this.qa.Ha(a,!0);CWd(this.qa);aj(this.L,this.kb,J.gN,void 0,v(this.X6a,this),v(this.s5,this,J.gN.getId()));CWd(this.ea);EWd(this,this.Bb,J.hU,!1);CWd(this.Ra);this.getHandler().R(this.D.getElement(),Ic?"focusin":"focus",this.tEb);this.Ja=new Rt(this.getElement());this.va(this.Ja);a=vHa("Ctrl+single-quote",!1);b=vHa("Ctrl+semicolon",!1);yHa(this.Ja,J.s2,[a]);yHa(this.Ja,J.t2,[b])};
p.focus=function(){Oh(this.Sa)?CS(this.H):this.Ua.focus()};function DWd(a,b,c,d,e,f){c=f.getElement(c);a.Wa(c);xU(a,1);r6b(a,b.getElement());xU(b,2);b=new tj(c,a.Ke()?1:5);q6b(a,b);aj(e,a,d,cj)}p.MUa=function(a){a=Sd("docs-spellcheckslidingdialog-count",a.getElement());this.oa().Je(a,"")};function FWd(a){var b=a.H.Ma();a=new pWd(b,a.l5(a.J),a.J);J.hN.jc(a)}p.cwb=function(){FWd(this)};p.BKa=function(){var a=this.oa().Iq(this.F);dh(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};
p.AKa=function(){var a=this.oa().Iq(this.F);fh(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};p.CKa=function(a){13==a.keyCode&&FWd(this)};p.tEb=function(){for(var a=0;a<this.D.Tc();a++){var b=this.D.dd(a);if(b.isChecked()){b.Lf(!0);return}}0<this.D.Tc()&&this.D.ag(0)};function GWd(a){for(var b=0;b<a.D.Tc();b++)a.D.dd(b).Bc(!1)}p.DKa=function(){GWd(this);this.Wb.Kl(!0)};p.VFb=function(a){var b=a.target.Ma();GWd(this);this.H.Qa(b);(a=a.target)&&1<this.D.Tc()&&a.Bc(!0);CS(this.H)};
p.Uhb=function(){var a=this.H.Ma();return new pWd(a,this.l5(this.J),this.J)};p.X6a=function(){var a=this.J;a=a.C?a.C.C:null;return new oWd(this.H.Ma(),a)};function EWd(a,b,c,d){aj(a.L,b,c,d?cj:void 0,v(a.l5,a,a.J),v(a.s5,a,c.getId()))}p.l5=function(a){return(a=a.C)?a.C.ov():null};p.Fa=function(){Ai(this.ib);C(this.O);AWd.ma.Fa.call(this)};function BWd(a,b){tk.call(this,a,b)}x(BWd,tk);BWd.prototype.zj=function(a){return 27==a.keyCode?!1:BWd.ma.zj.call(this,a)};function HWd(){var a=Y5.getInstance(),b=uo.getInstance();this.H=a;this.C=b;this.D=0}HWd.prototype.F=function(a){this.H.F(a);a=xo(N(aWd,{NT:a}),J.jn.getLabel(),v(this.L,this,a),"info",!0,1E4);vo(this.C,this.D);this.D=this.C.postMessage(a)};HWd.prototype.L=function(a){this.H.L(a);a=xo(N(bWd,{NT:a}),J.jn.getLabel(),v(this.F,this,a),"info",!0,1E4);vo(this.C,this.D);this.D=this.C.postMessage(a)};function IWd(a,b,c,d,e,f,h,k){E.call(this);this.J=a;this.H=b;this.L=c;this.D=e;this.gb=k||new Md;this.C=new AWd(this.H,this.D,this.L,d,f,h,this.gb);this.va(this.C);this.Ka=new K(this);this.va(this.Ka)}x(IWd,E);IWd.prototype.F=function(){this.Ka.Nc(this.C,"close",this.F);this.dispatchEvent("docs-text-spellcheckdialogcontroller-closed");sCa(Jr.getInstance())||this.J.Db(3);J.Fk.isEnabled()||uo.getInstance().postMessage(wo("Spellcheck will be unavailable until you reconnect.","info",!0,1E4))};function JWd(a){A.call(this);this.F=a;this.C={};this.D=new K(this);this.va(this.D);this.D.R(a,"Na",this.H)}x(JWd,A);function tWd(a,b,c){if(a=a.C[""+c.C])if(c=a.ef(c.yd.y,c.yd.x))return!!c.contains(b.toLowerCase());return!1}JWd.prototype.H=function(a){C(this.C[""+a.Vg]);delete this.C[""+a.Vg]};function KWd(){this.C=[]};function LWd(a,b,c){this.D=a;this.F=c||null;this.C=b}LWd.prototype.ov=g("D");LWd.prototype.cQ=g("F");LWd.prototype.equals=function(a){var b=a.ov(),c=a.cQ();a=pc(a.C);return this.D==b&&this.F==c&&xb(pc(this.C),a)};function b6(){T.call(this)}x(b6,T);var MWd=null;b6.prototype.rangeCount=function(){return kw(this,2)};function c6(){T.call(this)}x(c6,T);var NWd=null;c6.prototype.Zb=function(){return V(this,1)};function OWd(){T.call(this)}x(OWd,T);var PWd=null;function d6(){T.call(this)}x(d6,T);var QWd=null;d6.prototype.HJ=function(){return V(this,2)};function e6(){T.call(this)}x(e6,T);var RWd=null;e6.prototype.ov=function(){return V(this,1)};e6.prototype.cQ=function(){return V(this,5)};
b6.prototype.Ca=function(){var a=MWd;a||(MWd=a=ww(b6,{0:{name:"SpellcheckRequest",qb:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",Aa:5,type:Number},2:{name:"range",Aa:11,type:Pw},3:{name:"search_all_sheets",Aa:8,type:Boolean},4:{name:"active_filter_views",zc:!0,Aa:11,type:c6}}));return a};b6.Ca=b6.prototype.Ca;
c6.prototype.Ca=function(){var a=NWd;a||(NWd=a=ww(c6,{0:{name:"FilterViewDataProto",qb:"ritzproto.FilterViewDataProto"},1:{name:"grid_id",Aa:9,type:String},2:{name:"filter_view_id",Aa:9,type:String}}));return a};c6.Ca=c6.prototype.Ca;
OWd.prototype.Ca=function(){var a=PWd;a||(PWd=a=ww(OWd,{0:{name:"SpellcheckResponse",qb:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",Aa:5,type:Number},2:{name:"last_column_searched",Aa:5,type:Number},3:{name:"last_grid_id_searched",Aa:9,type:String},4:{name:"searched_all_sheets",Aa:8,type:Boolean},6:{name:"searched_whole_range",Aa:8,type:Boolean},5:{name:"cell_suggestions",zc:!0,Aa:11,type:d6}}));return a};OWd.Ca=OWd.prototype.Ca;
d6.prototype.Ca=function(){var a=QWd;a||(QWd=a=ww(d6,{0:{name:"CellSuggestionsProto",qb:"ritzproto.CellSuggestionsProto"},1:{name:"phrase_suggestions",zc:!0,Aa:11,type:e6},2:{name:"cell",Aa:11,type:ny}}));return a};d6.Ca=d6.prototype.Ca;
e6.prototype.Ca=function(){var a=RWd;a||(RWd=a=ww(e6,{0:{name:"PhraseSuggestionsProto",qb:"ritzproto.PhraseSuggestionsProto"},1:{name:"original_word",Aa:9,type:String},2:{name:"offset_start_index",Aa:5,type:Number},3:{name:"offset_end_index",Aa:5,type:Number},4:{name:"suggestions",zc:!0,Aa:9,type:String},5:{name:"spelling_language",Aa:9,type:String}}));return a};e6.Ca=e6.prototype.Ca;function SWd(a,b,c){this.yd=a;this.C=b;this.Oe=c}SWd.prototype.equals=function(a){return this===a?!0:a instanceof SWd?Ed(a.yd,this.yd)&&a.C==this.C&&wMa(a.Oe,this.Oe):!1};function f6(a,b,c,d,e){this.H=a;this.Sa=b;this.Ua=c;this.Ra=d;this.Oa=e;this.D=this.J=this.C=null;this.O=!1;this.L=[];this.ea=[];this.qa=new K(this);this.va(this.qa);this.$=null;this.V="RANGE";this.Ga=new yw;this.Ga.Bi=!0;this.Ba=new yw;this.Ba.Bi=!1}x(f6,A);f6.prototype.Ja=g("C");function uWd(a){VK(a.$);a.qa.Hc();a.V="RANGE";a.O=!1;a.L=[];a.ea=[]}
function TWd(a,b){var c=b.getSelection(),d=zI(a.H,c.C),e;(e=!d)||(d=d.Jc(),e=c.yd,e=!(QI(yH(d,"r"),e.y)&&QI(yH(d,"c"),e.x)));if(e)return!1;c=c.Oe;a=UWd(a,b);b=b.C.ov();return a.substring(c.start,c.end)==b}function UWd(a,b){a=VWd(a,b);return Eb(a,"'")?a.substring(1):a}function WWd(a,b){a=VWd(a,b);return Eb(a,"'")}function VWd(a,b){b=b.getSelection();var c=b.yd,d=b.C;a=zI(a.H,d).Jc();a.Vs(GA(b.yd));return DI(a.Wg(c.y,c.x),d,c.y,c.x)}
function XWd(a,b){if(a.D){var c=new b6,d=new Pw;W(d,1,a.D);W(d,2,a.J.y);switch(a.V){case "WORKBOOK":W(c,3,!0);d.tu(0);var e=AJ(a.H);for(var f=0;f<e.length;f++)0==e[f].getSheetType()&&YWd(c,e[f]);break;case "SHEET":d.tu(0);e=zI(a.H,a.F.kd);YWd(c,e);break;case "RANGE":d.tu(a.F.rect.mc()),Qw(d,a.F.rect.Sc()),d.Hx(a.F.rect.Vc()),e=zI(a.H,a.F.kd),YWd(c,e)}W(c,2,d);W(c,1,a.J.x+1);bu(Tq(Hs(Uq(a.Sa.He("/spell"),{data:a.Ga.serialize(c)}),"POST"),function(a){this.Qk(a,b)},a),function(){this.Qk(null,b)},a).le()}else ZWd(a,
b,!1)}function YWd(a,b){if(b){var c=b.Jc().J;if(uH(c)){b=""+b.yb();c=KI(c);var d=new c6;W(d,1,b);W(d,2,c);rw(a,4,d)}}}
f6.prototype.Qk=function(a,b){if(a){a=this.Ba.xd(OWd.Ca(),a.Te());this.J=new Dd(V(a,2),V(a,1));this.D=V(a,3);this.O=V(a,6);a=uw(a,5);for(var c=0;c<a.length;c++){var d=a[c],e=d.HJ().Wr(),f=d.HJ().getColumnIndex();e=new Dd(f,e);f=parseInt(d.HJ().yb(),10);d=uw(d,1);for(var h=0;h<d.length;h++){var k=d[h],l=k.ov(),m=V(k,2),r=V(k,3),u=k.cQ();m=new SWd(e,f,new Ru(m,r));if(!$Wd(this,l,m)){k=uw(k,4);r={};for(var w=0;w<k.length;w++)r[k[w]]=new KWd;this.L.push(new nWd(new LWd(l,r,u),m))}}}}vWd(this,b,!1)};
function vWd(a,b,c){if(c){var d=a.ea;var e=v(d.pop,d)}else d=a.L,e=v(d.shift,d);for(;0<d.length;){var f=e(),h=f.C.ov();if(!$Wd(a,h,f.getSelection())){e=c;h=f.getSelection();c=zI(a.H,h.C);d=c.Jc();h=GA(h.yd);f=v(a.Na,a,f,b,e);d.Vs(h)?f():(VK(a.$),a.$=DH(c.C,h).addCallback(f));return}}ZWd(a,b,c)}function ZWd(a,b,c){a.O||c?(a.C=null,b(null)):XWd(a,b)}f6.prototype.Na=function(a,b,c){TWd(this,a)?(this.C=a,b(a.C)):vWd(this,b,c)};
function $Wd(a,b,c){return a.Ra.C.contains(b.toLowerCase())||tWd(a.Oa,b,c)||a.Ua.C.contains(b.toLowerCase())}f6.prototype.Fa=function(){f6.ma.Fa.call(this);VK(this.$)};function aXd(a,b,c,d){this.D=a;this.F=b;this.C=c;this.H=d}
function rWd(a,b){var c=b.D.C;if(TWd(a.C,c)){var d=c.getSelection(),e=d.C,f=d.Oe,h=zI(a.D,e).Jc(),k=WWd(a.C,c);c=UWd(a.C,c);var l=new XO(h,GA(d.yd),(k?"'":"")+c.substring(0,f.start)+b.C+c.substring(f.end));HG(l,v(function(a){if(a){a=this.C;for(var c=b.C,e=0;e<a.L.length;e++){var f=a.L[e].getSelection();if(Ed(f.yd,d.yd)&&f.C==d.C&&f.Oe.start>d.Oe.end){var h=d.Oe.getLength()-c.length;f.Oe.start-=h;f.Oe.end-=h}}}},a));DU(a.D,new WA(e,"",GA(d.yd)),v(function(){this.F.C(l)},a))}}
function wWd(a,b){b&&DU(a.D,new WA(b.C,"",GA(b.yd)))};function bXd(a){this.D=new BAc(a)}bXd.prototype.C=function(a){var b=new oy,c=new Pw;W(c,2,a.yd.y);Qw(c,a.yd.y+1);c.tu(a.yd.x);c.Hx(a.yd.x+1);W(c,1,""+a.C);rw(b,2,c);c=new ny;W(c,1,""+a.C);W(c,2,a.yd.y);W(c,3,a.yd.x);W(b,1,c);return this.D.C(new eB(b))};function cXd(a,b,c,d,e,f,h,k){aX.call(this,"docs-spellcheckslidingdialog-id",c);this.H=v(this.Ora,this);this.Ga=a;this.Oa=new HWd;this.Ba=new lWd;this.qa=new JWd(a);this.J=new f6(a,e,Y5.getInstance(),this.Ba,this.qa);this.Na=new aXd(a,b,this.J,this.qa);b=Ld();e=new mWd;a=new IWd(c,(new Ik).build(),new bXd(a),new WVd("trigger-text",!1),this.J,k,e,b);this.va(a);this.V=a.C;this.D=new qWd(a,this.Ba,this.J,this.Na,d,this.Oa);this.F=b.xa("DIV",{style:"margin-top: 10px"});this.L=jS("Search the rest of the sheet",
b);this.L.render(this.F);this.getHandler().R(this.L,"action",this.xTb);this.O=jS("Search all sheets",b);this.O.render(this.F);this.getHandler().R(this.O,"action",v(this.Ora,this,"WORKBOOK"));es(h,Y5.getInstance(),"docs-user_dictionary");J.gU.subscribe("action",this.D.Gob,this.D);J.hU.subscribe("action",this.D.Otb,this.D);J.nU.subscribe("action",this.D.Hyb,this.D);J.hN.subscribe("action",this.D.R9a,this.D);J.gN.subscribe("action",this.D.Xmb,this.D);J.s2.subscribe("action",v(this.D.aKa,this.D,!1));
J.t2.subscribe("action",v(this.D.aKa,this.D,!0));d=Ie(this.V);h=new a6(Y5.getInstance());f.Oi(h);this.Ja=Ba(kWd,h,d)}x(cXd,aX);p=cXd.prototype;p.XP=g("V");p.yu=function(){cXd.ma.yu.call(this);this.getHandler().R(this.C,"close",this.j0b).R(this.Ga,"Sa",this.k0b)};p.j0b=function(){this.tB()};p.k0b=function(){this.C.Sq();this.tB()};
p.Ora=function(a,b){var c=b||null,d;a||((b=this.Ga.C)?0==b.getSheetType()?(c=b.Jc().Kc(),1<c.dh()?(a="RANGE",c=new WA(b.yb(),b.Vd(),c)):(a="SHEET",c=new WA(b.yb(),b.Vd(),null))):a="WORKBOOK":a="WORKBOOK");"WORKBOOK"!=a&&(d=15E3);switch(a){case "RANGE":this.L.setVisible(!0);this.O.setVisible(!0);L(this.F,!0);break;case "SHEET":this.L.setVisible(!1);this.O.setVisible(!0);L(this.F,!0);break;case "WORKBOOK":L(this.F,!1)}b=this.J;uWd(b);b.V=a;b.F=c;switch(a){case "WORKBOOK":b.J=new Dd(-1,0);(a=b.H.D5(-1,
0,!1,!0))?b.D=""+a.yb():(b.D=null,b.O=!0);break;case "SHEET":b.J=new Dd(-1,0);b.D=""+c.kd;break;case "RANGE":b.J=new Dd(c.rect.left-1,c.rect.top),b.D=""+c.kd}a=this.V;a.Cb=this.F;a.kc=d?d:5E3;a=this.D;J.Zca.Lc(!0);a.Ka.R(a.F,"docs-text-spellcheckdialogcontroller-closed",a.ACa);d=a.F;a=v(a.NLb,a);b=d.D.C;d.C.Rb()||d.C.render(Ae(d.gb,"docs-spellcheckslidingdialog-id"));(c=d.C.nJ)&&b?d.C.focus():(c||d.Ka.R(d.C,"close",d.F),a())};p.l0b=function(a){this.Ja(a)};
p.xTb=function(){var a=this.J.F;this.Ora("SHEET",new WA(a.kd,a.Kg,null))};function dXd(){A.call(this)}x(dXd,xB);dXd.prototype.C=function(a,b,c,d,e,f,h,k){return new cXd(a,b,c,d,e,f,h,k)};JB("spellcheck",dXd);
